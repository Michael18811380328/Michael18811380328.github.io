"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["9031"],{1093:function(e,n,s){s.r(n),s.d(n,{default:function(){return l}});var r=s(6469),a=s(8809);function t(e){let n=Object.assign({h1:"h1",a:"a",p:"p",h3:"h3",pre:"pre",code:"code",ul:"ul",li:"li"},(0,a.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h1,{id:"配置说明",children:["配置说明",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#配置说明",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"统计信息：字数 7690  阅读16分钟"}),"\n",(0,r.jsxs)(n.h3,{id:"第三方依赖版本",children:["第三方依赖版本",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#第三方依赖版本",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'"babel-cli": "^6.26.0",\n"babel-plugin-transform-runtime": "^6.23.0",\n"babel-preset-env": "^1.7.0",\n"babel-preset-es2015": "^6.24.1",\n"babel-preset-react": "^6.24.1",\n"babel-preset-stage-2": "^6.24.1",\n"webpack": "4.29.6",\n"webpack-cli": "^3.3.4",\n"webpack-dev-server": "3.2.1",\n"webpack-manifest-plugin": "2.0.4",\n"workbox-webpack-plugin": "4.2.0"\n'})}),"\n",(0,r.jsx)(n.p,{children:"需要注意高版本和低版本的兼容，还有 webpack-babel 不同版本的配置文件不同"}),"\n",(0,r.jsxs)(n.h3,{id:"script-脚本说明",children:["Script 脚本说明",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#script-脚本说明",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "pub:lib": "export BABEL_ENV=node && ./node_modules/.bin/babel src --out-dir lib --copy-files",\n  "pub:esm": "export BABEL_ENV=production && ./node_modules/.bin/babel src --out-dir es --copy-files",\n  "pub:umd": "export BABEL_ENV=production && webpack --config ./config/webpack.config.pub.js",\n  "pub:optimized": "rm es/settings.js es/i18n.js es/index.local.js && rm lib/settings.js lib/i18n.js lib/index.local.js",\n  "prepublishOnly": "npm run pub:lib && npm run pub:esm && npm run pub:umd && npm run pub:optimized"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"发布前，依次执行上面的四个脚本"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"pub:lib 在 node 环境下 babel 编译代码到 lib 目录下"}),"\n",(0,r.jsx)(n.li,{children:"pub:esm 在生产环境下 bebel 编译代码到 es 目录下"}),"\n",(0,r.jsx)(n.li,{children:"pub:umd 在生产环境下 webpack 使用配置文件进行编译（入口出口在配置文件中）"}),"\n",(0,r.jsx)(n.li,{children:"pub:optimized 删除本地配置文件和翻译文件"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"前两步应该兼容开发环境（node环境，web开发环境，web生产环境）"}),"\n",(0,r.jsxs)(n.h3,{id:"makefile-脚本说明",children:["Makefile 脚本说明",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#makefile-脚本说明",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-makefile",children:'dist: clean transpile postdist\n\nclean:\n	@echo \'--\x3e Cleaning dist\'\n	rm -rf dist/* 2> /dev/null\n	@echo "\\033[32;36m clean dist success \\033[0m"\n\ntranspile:\n	@echo "--\x3e Compile dist"\n	export NODE_ENV=production && node_modules/babel-cli/bin/babel.js src --out-dir dist\n	@echo "\\033[32;36m compile dist success \\033[0m"\n\npostdist:\n	@echo "--\x3e Copy css and remove settings.js"\n	cp -r src/css dist && cp -r src/lib/css dist/lib && rm dist/settings.js\n	@echo "\\033[32;36m post dist success \\033[0m"\n\n.PHONY: transpile postdist clean\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"babelrc-配置说明",children:["babelrc 配置说明",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#babelrc-配置说明",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"editor"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:"{ \n  \"presets\": [\n    \"es2015\",\n    \"react\",\n    \"env\",\n    \"stage-2\"\n  ],\n  'plugins': [\n    [\n      'transform-runtime', \n      {\n        'helpers': false,\n        'polyfill': false,\n        'regenerator': true,\n        'moduleName': 'babel-runtime'\n      }\n    ]\n  ]\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Table"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'{\n  "env": {\n    "test": {\n      "presets": [["react-app", {"absoluteRuntime" : false, "BABEL_ENV" : "test"}]],\n    },\n    "development": {\n      "presets": [["react-app", {"absoluteRuntime" : false, "BABEL_ENV" : "development"}]],\n    },\n    "production": {\n      "presets": [["react-app", {"absoluteRuntime" : false, "BABEL_ENV" : "production"}]],\n    },\n    "node": {\n      "presets": [\n        [\n          "@babel/env",\n          {\n            "loose": true,\n            "shippedProposals": true,\n            "modules": "commonjs",\n          }\n        ],\n        "@babel/react"\n      ],\n      "plugins": [\n        "@babel/plugin-proposal-export-default-from", \n        "@babel/plugin-proposal-export-namespace-from", \n        "@babel/plugin-proposal-class-properties",\n        "@babel/plugin-proposal-object-rest-spread",\n        "@babel/plugin-transform-runtime",\n      ]\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"TODO：未来专门弄一个文件学习 babel 及配置作用（基本会使用）"}),"\n",(0,r.jsxs)(n.h3,{id:"webpackconfigpubjs-配置说明",children:["webpack.config.pub.js 配置说明",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#webpackconfigpubjs-配置说明",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"const path = require('path');\nconst TerserPlugin = require('terser-webpack-plugin');\n\nmodule.exports = {\n  mode: 'production', \n  entry: {\n    index: [\n      require.resolve('./polyfills'),\n      path.resolve(__dirname, '../src/index.js')\n    ]\n  },\n  output: {\n    path: path.resolve(__dirname, \"../dist/\"),\n    filename: 'table.js',\n    libraryTarget: 'umd',\n    libraryExport: 'default',\n    umdNamedDefine: true,\n    globalObject: 'typeof self !== \\'undefined\\' ? self : this'\n  },\n  externals: {\n    react: {\n      root: 'React',\n      var: 'React',\n      commonjs: 'react',\n      commonjs2: 'react',\n      amd: 'react',\n    },\n    'react-dom': {\n        root: 'ReactDOM',\n        var: 'ReactDOM',\n        commonjs: 'react-dom',\n        commonjs2: 'react-dom',\n        amd: 'react-dom',\n    },\n    'prop-types': {\n        root: 'PropTypes',\n        var: 'PropTypes',\n        commonjs: 'prop-types',\n        commonjs2: 'prop-types',\n        amd: 'prop-types',\n    },\n  },\n  module: {\n    rules: [\n      {\n        test: /\\.(js|jsx|mjs)$/,\n        exclude: /node_modules/,\n        use: {\n          loader: 'babel-loader',\n          options: {\n            compact: true,\n            cacheDirectory: false,\n          },\n        }\n      },\n      { \n        test: /\\.css$/, \n        use: ['style-loader','css-loader']\n      },\n      {\n        test: /\\.less$/,\n        use:  [\n          {loader: 'style-loader'},\n          {loader: 'css-loader'}, \n          {\n            loader: 'less-loader',\n            options: {\n              javascriptEnabled: true\n            }\n          }\n        ],\n      },\n      {\n        test: [/\\.bmp$/, /\\.gif$/, /\\.jpe?g$/, /\\.png$/],\n        loader: require.resolve('url-loader'),\n        options: {\n          limit: 10000,\n          name: 'images/[name]-[hash:8].[ext]',\n        },\n      }\n    ]\n  },\n  optimization: {\n    minimize: true,\n    minimizer: [\n      // This is only used in production mode\n      new TerserPlugin({\n        terserOptions: {\n          parse: {\n            // We want terser to parse ecma 8 code. However, we don't want it\n            // to apply any minification steps that turns valid ecma 5 code\n            // into invalid ecma 5 code. This is why the 'compress' and 'output'\n            // sections only apply transformations that are ecma 5 safe\n            // https://github.com/facebook/create-react-app/pull/4234\n            ecma: 8,\n          },\n          compress: {\n            ecma: 5,\n            warnings: false,\n            // Disabled because of an issue with Uglify breaking seemingly valid code:\n            // https://github.com/facebook/create-react-app/issues/2376\n            // Pending further investigation:\n            // https://github.com/mishoo/UglifyJS2/issues/2011\n            comparisons: false,\n            // Disabled because of an issue with Terser breaking valid code:\n            // https://github.com/facebook/create-react-app/issues/5250\n            // Pending further investigation:\n            // https://github.com/terser-js/terser/issues/120\n            inline: 2,\n          },\n          mangle: {\n            safari10: true,\n          },\n          // Added for profiling in devtools\n          keep_classnames: true,\n          keep_fnames: true,\n          output: {\n            ecma: 5,\n            comments: false,\n            // Turned on because emoji and regex is not minified properly using default\n            // https://github.com/facebook/create-react-app/issues/2488\n            ascii_only: true,\n          },\n        },\n        // Use multi-process parallel running to improve the build speed\n        // Default number of concurrent runs: os.cpus().length - 1\n        // Disabled on WSL (Windows Subsystem for Linux) due to an issue with Terser\n        // https://github.com/webpack-contrib/terser-webpack-plugin/issues/21\n        parallel: false,\n        // Enable file caching\n        cache: true,\n        sourceMap: false,\n      }),\n    ],\n  },\n  node: {\n    setImmediate: false,\n    dgram: \"empty\",\n    fs: \"empty\",\n    net: \"empty\",\n    tls: \"empty\",\n    child_process: \"empty\"\n  }\n} \n"})}),"\n",(0,r.jsx)(n.p,{children:"这是 webpack 配置文件，未来要学会"}),"\n",(0,r.jsxs)(n.h3,{id:"附录",children:["附录",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#附录",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["babel-preset-env 说明：",(0,r.jsx)(n.a,{href:"https://www.cnblogs.com/chyingp/p/understanding-babel-preset-env.html",target:"_blank",rel:"noopener noreferrer",children:"https://www.cnblogs.com/chyingp/p/understanding-babel-preset-env.html"})]})]})}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,a.ah)(),e.components);return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}let l=i;i.__RSPRESS_PAGE_META={},i.__RSPRESS_PAGE_META["webpack%2F48-webpack%20%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AE%E5%AD%A6%E4%B9%A03.md"]={toc:[{text:"第三方依赖版本",id:"第三方依赖版本",depth:3},{text:"Script 脚本说明",id:"script-脚本说明",depth:3},{text:"Makefile 脚本说明",id:"makefile-脚本说明",depth:3},{text:"babelrc 配置说明",id:"babelrc-配置说明",depth:3},{text:"webpack.config.pub.js 配置说明",id:"webpackconfigpubjs-配置说明",depth:3},{text:"附录",id:"附录",depth:3}],title:"配置说明",frontmatter:{}}}}]);