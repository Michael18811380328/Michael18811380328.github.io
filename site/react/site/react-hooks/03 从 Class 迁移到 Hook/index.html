
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Michael An">
      
      
        <link rel="canonical" href="https://michael18811380328.github.io/react-hooks/03%20%E4%BB%8E%20Class%20%E8%BF%81%E7%A7%BB%E5%88%B0%20Hook/">
      
      
        <link rel="prev" href="../02%20%E8%BD%BB%E6%9D%BE%E5%AD%A6%E4%BC%9A%20React%20%E9%92%A9%E5%AD%90-%E4%BB%A5%20useEffect%28%29%20%E4%B8%BA%E4%BE%8B-%E9%98%AE%E4%B8%80%E5%B3%B0/">
      
      
        <link rel="next" href="../04%20React%20%E5%86%85%E7%BD%AE%20Hook/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>03 从 Class 迁移到 Hook - Michale An Blog</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#03-class-hook" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Michale An Blog" class="md-header__button md-logo" aria-label="Michale An Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Michale An Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              03 从 Class 迁移到 Hook
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/Michael18811380328/Michael18811380328.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Michael18811380328/Michael18811380328.github.io
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Michale An Blog" class="md-nav__button md-logo" aria-label="Michale An Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Michale An Blog
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Michael18811380328/Michael18811380328.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Michael18811380328/Michael18811380328.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    index
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    new-third-part-lib
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            new-third-part-lib
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/%40excalidraw_excalidraw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    @excalidraw_excalidraw
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/Bootstrap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bootstrap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/JS-Bridge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JS-Bridge
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/JSON%20Server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON Server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/JSzip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSzip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/Leaflet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Leaflet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/Mocha/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mocha
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/React%20Image%20Lightbox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React Image Lightbox
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/React-Sweet-Progress/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React-Sweet-Progress
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/Rxjs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rxjs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/Storybook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Storybook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/ThreeJS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ThreeJS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/UUID-js/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UUID-js
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/YesPlayMusic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YesPlayMusic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/ant-design-vue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ant-design-vue
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/antd-mobile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    antd-mobile
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/arco-design-vue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    arco-design-vue
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/autoprefixer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    autoprefixer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/awesome-vue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    awesome-vue
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/axios/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    axios
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/babel-cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    babel-cli
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/babel-eslint/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    babel-eslint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/babel-jest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    babel-jest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/babel-loader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    babel-loader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/babel-plugin-named-asset-import/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    babel-plugin-named-asset-import
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/babel-preset-env/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    babel-preset-env
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/babel-preset-react-app/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    babel-preset-react-app
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/babel-preset-react/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    babel-preset-react
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/case-sensitive-paths-webpack-plugin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    case-sensitive-paths-webpack-plugin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/chartjs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chartjs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/classnames/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    classnames
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/clean-webpack-plugin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    clean-webpack-plugin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/connect-multiparty/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    connect-multiparty
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/copy-to-clipboard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    copy-to-clipboard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/crypto-js/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    crypto-js
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/css-loader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    css-loader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/csv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    csv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/date-format/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    date-format
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/dayjs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dayjs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/debug/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    debug
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/deep-copy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deep-copy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/detect-character-encoding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    detect-character-encoding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/dir/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dir
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/docxtemplater/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docxtemplater
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/dom-helper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dom-helper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/dom-helpers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dom-helpers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/dotenv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dotenv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/editor-js/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    editor-js
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/element-plus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    element-plus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/element-ui/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    element-ui
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/enzyme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    enzyme
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/eslint-config-react-app/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eslint-config-react-app
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/eslint-loader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eslint-loader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/eslint-plugin-flowtype/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eslint-plugin-flowtype
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/eslint-plugin-import/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eslint-plugin-import
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/eslint-plugin-react/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eslint-plugin-react
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/eslint/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eslint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/etcd3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    etcd3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/excalidraw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    excalidraw
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/exif-js/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exif-js
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/express-rate-limit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    express-rate-limit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/express/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    express
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/file-loader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    file-loader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/file-saver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    file-saver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/form-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    form-data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/formik/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    formik
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/github-copilot-resources_copilot-metrics-viewer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    github-copilot-resources_copilot-metrics-viewer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/glamor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    glamor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/gojs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gojs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/html2canvas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    html2canvas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/http-server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    http-server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/i18next-browser-languagedetector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    i18next-browser-languagedetector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/i18next-xhr-backend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    i18next-xhr-backend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/i18next/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    i18next
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/iconv-lite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iconv-lite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/is-hotkey/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    is-hotkey
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/isScroll/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    isScroll
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/jest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/jison/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jison
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/jsonwebtoken/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jsonwebtoken
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/keymirror/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    keymirror
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/lerna/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lerna
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/lodash-throttle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lodash-throttle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/lodash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lodash
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/log4js/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    log4js
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/luckysheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    luckysheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/mind-map/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mind-map
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/mockjs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mockjs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/moment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    moment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/mysql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mysql
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/number-precision/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    number-precision
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/parcel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    parcel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/postcss-loader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    postcss-loader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/postcss-normalize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    postcss-normalize
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/postcss-preset-env/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    postcss-preset-env
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/postcss-safe-parser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    postcss-safe-parser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/promise/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    promise
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/puppeteer-print-pdf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    puppeteer-print-pdf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/pure-admin_vue-pure-admin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pure-admin_vue-pure-admin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/quasar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    quasar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/raf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    raf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/rc-calendar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rc-calendar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/react-cookies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react-cookies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/react-dnd-html5-backend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react-dnd-html5-backend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/react-dnd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react-dnd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/react-i18next/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react-i18next
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/react-intl-universal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react-intl-universal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/react-is-deprecated/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react-is-deprecated
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/react-is/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react-is
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/reactstrap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    reactstrap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/redis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/request/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    request
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/reselect/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    reselect
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/resolve-url-loader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    resolve-url-loader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/resolve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    resolve
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/response-time/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    response-time
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/resumablejs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    resumablejs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/ron-react-autocomplete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ron-react-autocomplete
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/sass-loader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sass-loader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/semver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    semver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/shallow-equal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shallow-equal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/shallowequal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shallowequal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/simple-statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    simple-statistics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/slugid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    slugid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/socket%20io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    socket io
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/socket-io-client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    socket-io-client
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/socket-io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    socket-io
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/socket.io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    socket.io
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/sortable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sortable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/streamsaver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    streamsaver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/style-loader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    style-loader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/supertest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    supertest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/terser-webpack-plugin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    terser-webpack-plugin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/thingsboard-ui-vue3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    thingsboard-ui-vue3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/throttle-lodash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    throttle-lodash
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/tiny-vue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tiny-vue
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/ts-jest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ts-jest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/ts-pnp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ts-pnp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/tui-image-editor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tui-image-editor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/uglyJS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    uglyJS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/url-loader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    url-loader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/uuid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    uuid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/v-viewer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v-viewer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/vee-validate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vee-validate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/video-js/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    video-js
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/viewerjs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    viewerjs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/vite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/vue-draggable-resizable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vue-draggable-resizable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/vue-ruoyi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vue-ruoyi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/vue-virtual-scroller/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vue-virtual-scroller
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/vuecli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vuecli
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/vuepress/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vuepress
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/vuetify/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vuetify
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/vuex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vuex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/vxe-table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vxe-table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/wangeditor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wangeditor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/watermark/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    watermark
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/webpack-cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    webpack-cli
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/webpack-dev-server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    webpack-dev-server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/webpack-merge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    webpack-merge
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/webpack-node-externals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    webpack-node-externals
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/webpack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    webpack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/whatwg-fetch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    whatwg-fetch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/workbox-webpack-plugin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    workbox-webpack-plugin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/zyronon_douyin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    zyronon_douyin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-third-part-lib/%CE%BCPlot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    μPlot
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    react
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            react
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/Create-React-App/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create-React-App
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%20%26%20Webpack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React & Webpack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%2017%20%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E6%96%B0%E7%89%B9%E6%80%A7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React 17 事件处理新特性
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%2018%20%E8%B6%85%E5%85%A8%E5%8D%87%E7%BA%A7%E6%8C%87%E5%8D%97/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React 18 超全升级指南
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%20FAQ/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React FAQ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%20Fiber%20Architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React Fiber Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%20PureComponent%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React PureComponent 使用指南
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%20data%20grid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React data grid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%20%E4%B8%AD%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React 中的事件处理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%20%E5%90%84%E7%A7%8Dbug%20%E4%BC%9A%E5%AE%9E%E6%97%B6%E6%9B%B4%E6%96%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React 各种bug 会实时更新
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%20%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React 官方文档笔记
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%20%E5%B8%B8%E7%94%A8%E6%9C%AF%E8%AF%AD%E5%90%AB%E4%B9%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React 常用术语含义
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%20%E6%93%8D%E4%BD%9C%E5%85%83%E7%B4%A0%E7%9A%84API/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React 操作元素的API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%20%E6%B5%8B%E8%AF%95%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React 测试入门教程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%20%E7%9A%84%20PureComponent%20%E4%B8%8E%20Component/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React 的 PureComponent 与 Component
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%20%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B-%E4%BC%A0%E6%99%BA%E6%92%AD%E5%AE%A2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React 视频教程-传智播客
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%20%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B-%E6%8A%80%E6%9C%AF%E8%83%96/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React 视频教程-技术胖
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%20%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React 高阶组件
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React-Design%20Principles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React-Design Principles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React-Suspense%E7%9A%84%E5%AE%9E%E7%8E%B0%E4%B8%8E%E6%8E%A2%E8%AE%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React-Suspense的实现与探讨
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React-性能优化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React.Children%E7%9A%84API/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React.Children的API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React.Component/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React.Component
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/ReactRouter-%E9%98%AE%E4%B8%80%E5%B3%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReactRouter-阮一峰
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%E4%BA%8B%E4%BB%B6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React事件
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%E6%95%B0%E6%8D%AE%E6%B5%81/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React数据流
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%E6%96%B0%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F--getDerivedStateFromProps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React新生命周期--getDerivedStateFromProps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%E7%82%B9%E5%87%BB%E4%BA%8B%E4%BB%B6%E6%94%B9%E5%8F%98DOM%E6%96%B9%E6%B3%95/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React点击事件改变DOM方法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%B5%81%E7%A8%8B%E5%9B%BE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React生命周期流程图
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%E8%8E%B7%E5%8F%96%E5%B0%BA%E5%AF%B8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React获取尺寸
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/React%E8%BF%9B%E9%98%B6%E2%80%94%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React进阶—性能优化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/Refs%20%26%20DOM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Refs & DOM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/getDerivedStateFromProps%E7%9A%84%E4%BD%BF%E7%94%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getDerivedStateFromProps的使用
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/jsx%E8%AF%AD%E6%B3%95/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jsx语法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/react%20%E4%B8%AD%E9%80%9A%E8%BF%87ref%E8%8E%B7%E5%8F%96%E9%AB%98%E9%98%B6%EF%BC%88HOC%EF%BC%89%E5%AD%90%E7%BB%84%E4%BB%B6%E5%AE%9E%E4%BE%8B%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react 中通过ref获取高阶（HOC）子组件实例的解决方案
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/react%20%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E5%8F%8A%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react 项目结构及编码规范
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/react-redux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react-redux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/react-transition-group-%E5%8A%A8%E7%94%BB%E6%95%88%E6%9E%9C/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react-transition-group-动画效果
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/react-useRef/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react-useRef
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/reactjs%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-%E4%B8%8A%E7%AF%87%EF%BC%88%E9%A6%96%E6%AC%A1%E6%B8%B2%E6%9F%93%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    reactjs源码分析-上篇（首次渲染实现原理）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/reactjs%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-%E4%B8%8B%E7%AF%87%EF%BC%88%E6%9B%B4%E6%96%B0%E6%9C%BA%E5%88%B6%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    reactjs源码分析-下篇（更新机制实现原理）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/react%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react生命周期函数源码学习
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/stackoverflow-Highlight%20text%20using%20ReactJS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stackoverflow-Highlight text using ReactJS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/todo-Testing%20React%20components/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-Testing React components
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/todo-VS%20Code%20%E5%BF%AB%E6%8D%B7%E8%BE%93%E5%85%A5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-VS Code 快捷输入
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AF%B4Suspense%E6%98%AF%E4%B8%80%E7%A7%8D%E5%B7%A8%E5%A4%A7%E7%9A%84%E7%AA%81%E7%A0%B4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    为什么说Suspense是一种巨大的突破
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3-React%E9%AB%98%E9%98%B6API/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    官方文档-React高阶API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/%E5%AF%B9React%20children%E7%90%86%E8%A7%A3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    对React children理解
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/%E6%8E%8C%E6%8F%A1%E6%8B%96%E6%8B%BD%E7%9A%84%E5%AE%9E%E7%8E%B0%EF%BC%88%E4%BD%BF%E7%94%A8ReactJS%20hooks%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    掌握拖拽的实现（使用ReactJS hooks）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/%E6%A1%88%E4%BE%8B-React%20Hook%2BTS4%20%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E9%A1%B9%E7%9B%AE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    案例-React Hook+TS4 最佳实践项目
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/%E6%A1%88%E4%BE%8B-React%20Testing%20Library%20%E5%92%8C%20Jest%20%E5%AE%8C%E6%88%90%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    案例-React Testing Library 和 Jest 完成单元测试
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/%E6%A1%88%E4%BE%8B-React%E7%BB%84%E4%BB%B6%E5%BA%93%E6%90%AD%E5%BB%BA%E6%80%BB%E7%BB%93/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    案例-React组件库搭建总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/%E9%98%AE%E4%B8%80%E5%B3%B0%20react%20%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    阮一峰 react 系列教程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react/%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4%E7%9A%84%20REACT%202015%20%E4%B9%8B%E8%B7%AF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    阿里巴巴的 REACT 2015 之路
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    react-hooks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            react-hooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00%20React%20hook%20%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    00 React hook 笔记
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01%20React%20Hooks%20%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B-%E9%98%AE%E4%B8%80%E5%B3%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01 React Hooks 入门教程-阮一峰
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02%20%E8%BD%BB%E6%9D%BE%E5%AD%A6%E4%BC%9A%20React%20%E9%92%A9%E5%AD%90-%E4%BB%A5%20useEffect%28%29%20%E4%B8%BA%E4%BE%8B-%E9%98%AE%E4%B8%80%E5%B3%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    02 轻松学会 React 钩子-以 useEffect() 为例-阮一峰
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    03 从 Class 迁移到 Hook
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    03 从 Class 迁移到 Hook
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hook" class="md-nav__link">
    <span class="md-ellipsis">
      生命周期方法要如何对应到 Hook？
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      有类似实例变量的东西吗？
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#state" class="md-nav__link">
    <span class="md-ellipsis">
      我应该使用单个还是多个 state 变量？
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#props-state" class="md-nav__link">
    <span class="md-ellipsis">
      如何获取上一轮的 props 或 state？
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#props-state_1" class="md-nav__link">
    <span class="md-ellipsis">
      为什么我会在我的函数中看到陈旧的 props 和 state ？
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getderivedstatefromprops" class="md-nav__link">
    <span class="md-ellipsis">
      我该如何实现 getDerivedStateFromProps？
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dom" class="md-nav__link">
    <span class="md-ellipsis">
      我该如何测量 DOM 节点？
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      性能优化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="性能优化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      在依赖列表中省略函数是否安全？
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#effect" class="md-nav__link">
    <span class="md-ellipsis">
      如果我的 effect 的依赖频繁变化，我该怎么办？
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shouldcomponentupdate" class="md-nav__link">
    <span class="md-ellipsis">
      我该如何实现 shouldComponentUpdate?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      如何记忆计算结果？
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      如何惰性创建昂贵的对象？
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hook_1" class="md-nav__link">
    <span class="md-ellipsis">
      Hook 会因为在渲染时创建函数而变慢吗？
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      如何避免向下传递回调？
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usecallback" class="md-nav__link">
    <span class="md-ellipsis">
      如何从 useCallback 读取一个经常变化的值？
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      底层原理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="底层原理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#react-hook" class="md-nav__link">
    <span class="md-ellipsis">
      React 是如何把对 Hook 的调用和组件联系起来的？
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04%20React%20%E5%86%85%E7%BD%AE%20Hook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    04 React 内置 Hook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05%20React%20Hooks%20%E8%AF%A6%E8%A7%A3%20%2B%20%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    05 React Hooks 详解 + 项目实战
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06%20%E7%B2%BE%E9%80%9AReact%20Hooks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    06 精通React Hooks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07%20React%20Hooks%20%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    07 React Hooks 最佳实践
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08%20useMemo%E3%80%81useCallback%E3%80%81useContext/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    08 useMemo、useCallback、useContext
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09%20React-hook%2BTS%E7%B1%BB%E5%9E%8B%E9%AA%8C%E8%AF%81/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    09 React-hook+TS类型验证
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    react-third-part-lib
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            react-third-part-lib
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/01-CSDN%20%E5%8D%9A%E5%AE%A2%E6%96%87%E6%A1%A3%E9%93%BE%E6%8E%A5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01-CSDN 博客文档链接
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/030-react-is-deprecated/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    030-react-is-deprecated
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/031-react-sweet-progress/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    031-react-sweet-progress
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/032-reactstrap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    032-reactstrap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/044-react-app-polyfill/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    044-react-app-polyfill
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/045-react-dev-utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    045-react-dev-utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/046-react-dom/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    046-react-dom
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/069-react-codemirror/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    069-react-codemirror
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/073-react-i18next/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    073-react-i18next
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/101-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93-react-poker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    101-第三方库-react-poker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/103-react-to-print/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    103-react-to-print
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/112-react-select/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    112-react-select
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/113-react-image-lightbox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    113-react-image-lightbox
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/21-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93-react-window/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    21-第三方库-react-window
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/22-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93-react-mentions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    22-第三方库-react-mentions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/23-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93-react-loading-skeleton/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    23-第三方库-react-loading-skeleton
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/24-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93-react-konva/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    24-第三方库-react-konva
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/25-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93-react-canvas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    25-第三方库-react-canvas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/26-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93-react-image-lightbox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    26-第三方库-react-image-lightbox
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/React-Select/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React-Select
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/Todo-054-GGEditor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Todo-054-GGEditor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/gojs-react/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gojs-react
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/react-colorful/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react-colorful
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/react-lazy-load/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react-lazy-load
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/todo-00-React%20%E7%AC%94%E8%AE%B0%E7%9B%AE%E5%BD%95/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-00-React 笔记目录
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/todo-009-html2canvas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-009-html2canvas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/todo-017-qrcode-react/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-017-qrcode-react
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/todo-050-react-custom-scrollbars/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-050-react-custom-scrollbars
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/todo-052-react-select/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-052-react-select
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/todo-053-react-media/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-053-react-media
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/todo-055-DPlayer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-055-DPlayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/todo-20-React%20Router%20%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A31-v4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-20-React Router 中文文档1-v4
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/todo-20-React%20Router%20%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A32/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-20-React Router 中文文档2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/todo-20-react-router/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-20-react-router
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/todo-26-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93-react-use/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-26-第三方库-react-use
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/todo-27-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93-react-motion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-27-第三方库-react-motion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/todo-28-sort-by/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-28-sort-by
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/todo-29-localForage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-29-localForage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/todo-30-match-sorter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-30-match-sorter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/todo-31-zxing-library%20%E5%AE%9E%E7%8E%B0%E5%89%8D%E7%AB%AF%E6%89%AB%E7%A0%81%E5%8A%9F%E8%83%BD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-31-zxing-library 实现前端扫码功能
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/todo-32-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93-react-photoswipe-gallery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-32-第三方库-react-photoswipe-gallery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../react-third-part-lib/todo-33-React-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    todo-33-React-第三方库
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    third-part-lib/codemirror
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            third-part-lib/codemirror
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../third-part-lib/codemirror/Code-mirror/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code-mirror
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../third-part-lib/codemirror/codemirror-readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    codemirror-readme
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../third-part-lib/codemirror/codemirror/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    codemirror
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    third-part-lib/echarts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            third-part-lib/echarts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../third-part-lib/echarts/echarts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    echarts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    third-part-lib/g2
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            third-part-lib/g2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../third-part-lib/g2/antv-g2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    antv-g2
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    third-part-lib/react-dnd
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            third-part-lib/react-dnd
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../third-part-lib/react-dnd/01-readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01-readme
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../third-part-lib/react-dnd/02-quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    02-quickstart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../third-part-lib/react-dnd/03-Overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    03-Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../third-part-lib/react-dnd/API/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../third-part-lib/react-dnd/React%20DnD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    React DnD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../third-part-lib/react-dnd/Testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../third-part-lib/react-dnd/Tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../third-part-lib/react-dnd/react-dnd-DragLayer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react-dnd-DragLayer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../third-part-lib/react-dnd/react-dnd-DragSource/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react-dnd-DragSource
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../third-part-lib/react-dnd/react-dnd-DropTarget/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react-dnd-DropTarget
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../third-part-lib/react-dnd/react-dnd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react-dnd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../third-part-lib/react-dnd/react-dnd%E4%BD%BF%E7%94%A8%E6%89%8B%E8%AE%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    react-dnd使用手记
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%B8%B8%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93%E4%BB%8B%E7%BB%8D/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    常用第三方库介绍
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hook" class="md-nav__link">
    <span class="md-ellipsis">
      生命周期方法要如何对应到 Hook？
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      有类似实例变量的东西吗？
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#state" class="md-nav__link">
    <span class="md-ellipsis">
      我应该使用单个还是多个 state 变量？
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#props-state" class="md-nav__link">
    <span class="md-ellipsis">
      如何获取上一轮的 props 或 state？
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#props-state_1" class="md-nav__link">
    <span class="md-ellipsis">
      为什么我会在我的函数中看到陈旧的 props 和 state ？
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getderivedstatefromprops" class="md-nav__link">
    <span class="md-ellipsis">
      我该如何实现 getDerivedStateFromProps？
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dom" class="md-nav__link">
    <span class="md-ellipsis">
      我该如何测量 DOM 节点？
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      性能优化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="性能优化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      在依赖列表中省略函数是否安全？
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#effect" class="md-nav__link">
    <span class="md-ellipsis">
      如果我的 effect 的依赖频繁变化，我该怎么办？
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shouldcomponentupdate" class="md-nav__link">
    <span class="md-ellipsis">
      我该如何实现 shouldComponentUpdate?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      如何记忆计算结果？
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      如何惰性创建昂贵的对象？
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hook_1" class="md-nav__link">
    <span class="md-ellipsis">
      Hook 会因为在渲染时创建函数而变慢吗？
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      如何避免向下传递回调？
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usecallback" class="md-nav__link">
    <span class="md-ellipsis">
      如何从 useCallback 读取一个经常变化的值？
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      底层原理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="底层原理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#react-hook" class="md-nav__link">
    <span class="md-ellipsis">
      React 是如何把对 Hook 的调用和组件联系起来的？
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="03-class-hook">03 从 Class 迁移到 Hook<a class="headerlink" href="#03-class-hook" title="Permanent link">&para;</a></h1>
<p>统计信息：字数 32668  阅读66分钟</p>
<p><a href="https://zh-hans.legacy.reactjs.org/docs/hooks-faq.html#from-classes-to-hooks">https://zh-hans.legacy.reactjs.org/docs/hooks-faq.html#from-classes-to-hooks</a></p>
<h3 id="hook">生命周期方法要如何对应到 Hook？<a class="headerlink" href="#hook" title="Permanent link">&para;</a></h3>
<ul>
<li><code>constructor</code>：函数组件不需要构造函数。你可以通过调用 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-reference.html#usestate"><code>useState</code></a> 来初始化 state。如果计算的代价比较昂贵，你可以传一个函数给 <code>useState</code>。</li>
<li><code>getDerivedStateFromProps</code>：改为 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-faq.html#how-do-i-implement-getderivedstatefromprops">在渲染时</a> 安排一次更新。</li>
<li><code>shouldComponentUpdate</code>：详见 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-faq.html#how-do-i-implement-shouldcomponentupdate">下方</a> <code>React.memo</code>.</li>
<li><code>render</code>：这是函数组件体本身。</li>
<li><code>componentDidMount</code>, <code>componentDidUpdate</code>, <code>componentWillUnmount</code>：<a href="https://zh-hans.legacy.reactjs.org/docs/hooks-reference.html#useeffect"><code>useEffect</code> Hook</a> 可以表达所有这些(包括 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-faq.html#can-i-skip-an-effect-on-updates">不那么</a> <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-faq.html#can-i-run-an-effect-only-on-updates">常见</a> 的场景)的组合。</li>
<li><code>getSnapshotBeforeUpdate</code>，<code>componentDidCatch</code> 以及 <code>getDerivedStateFromError</code>：目前还没有这些方法的 Hook 等价写法，但很快会被添加。</li>
</ul>
<h3 id="_1">有类似实例变量的东西吗？<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p>有！<a href="https://zh-hans.legacy.reactjs.org/docs/hooks-reference.html#useref"><code>useRef()</code></a> Hook 不仅可以用于 DOM refs。「ref」 对象是一个 <code>current</code> 属性可变且可以容纳任意值的通用容器，类似于一个 class 的实例属性。</p>
<p>你可以在 <code>useEffect</code> 内部对其进行写入:</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Timer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">intervalRef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useRef</span><span class="p">();</span>

<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">setInterval</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// ...</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">    </span><span class="nx">intervalRef</span><span class="p">.</span><span class="nx">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">id</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">clearInterval</span><span class="p">(</span><span class="nx">intervalRef</span><span class="p">.</span><span class="nx">current</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>
<p>如果我们只是想设定一个循环定时器，我们不会需要这个 ref（<code>id</code> 可以是在 effect 本地的），但如果我们想要在一个事件处理器中清除这个循环定时器的话这就很有用了：</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="c1">// ...</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">handleCancelClick</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">clearInterval</span><span class="p">(</span><span class="nx">intervalRef</span><span class="p">.</span><span class="nx">current</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c1">// ...</span>
</code></pre></div>
<p>从概念上讲，你可以认为 refs 就像是一个 class 的实例变量。除非你正在做 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-faq.html#how-to-create-expensive-objects-lazily">懒加载</a>，否则避免在渲染期间设置 refs —— 这可能会导致意外的行为。相反的，通常你应该在事件处理器和 effects 中修改 refs。</p>
<h3 id="state">我应该使用单个还是多个 state 变量？<a class="headerlink" href="#state" title="Permanent link">&para;</a></h3>
<p>如果你之前用过 class，你或许会试图总是在一次 <code>useState()</code> 调用中传入一个包含了所有 state 的对象。如果你愿意的话你可以这么做。这里有一个跟踪鼠标移动的组件的例子。我们在本地 state 中记录它的位置和尺寸：</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Box</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">state</span><span class="p">,</span><span class="w"> </span><span class="nx">setState</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">({</span><span class="w"> </span><span class="nx">left</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">top</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="mf">100</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>
<p>现在假设我们想要编写一些逻辑以便在用户移动鼠标时改变 <code>left</code> 和 <code>top</code>。注意到我们是如何必须手动把这些字段合并到之前的 state 对象的：</p>
<div class="highlight"><pre><span></span><code><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">handleWindowMouseMove</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 展开 「...state」 以确保我们没有 「丢失」 width 和 height      </span>
<span class="w">    </span><span class="nx">setState</span><span class="p">(</span><span class="nx">state</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span><span class="w"> </span><span class="p">...</span><span class="nx">state</span><span class="p">,</span><span class="w"> </span><span class="nx">left</span><span class="o">:</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">pageX</span><span class="p">,</span><span class="w"> </span><span class="nx">top</span><span class="o">:</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">pageY</span><span class="w"> </span><span class="p">}));</span><span class="w">    </span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c1">// 注意：这是个简化版的实现</span>
<span class="w">  </span><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;mousemove&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleWindowMouseMove</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s1">&#39;mousemove&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleWindowMouseMove</span><span class="p">);</span>
<span class="p">},</span><span class="w"> </span><span class="p">[]);</span>
</code></pre></div>
<p>这是因为当我们更新一个 state 变量，我们会 <em>替换</em> 它的值。这和 class 中的 <code>this.setState</code> 不一样，后者会把更新后的字段 <em>合并</em> 入对象中。</p>
<p>如果你还怀念自动合并，你可以写一个自定义的 <code>useLegacyState</code> Hook 来合并对象 state 的更新。然而，<strong>我们推荐把 state 切分成多个 state 变量，每个变量包含的不同值会在同时发生变化。</strong></p>
<p>举个例子，我们可以把组件的 state 拆分为 <code>position</code> 和 <code>size</code> 两个对象，并永远以非合并的方式去替换 <code>position</code>：</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Box</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">position</span><span class="p">,</span><span class="w"> </span><span class="nx">setPosition</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">({</span><span class="w"> </span><span class="nx">left</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">top</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="p">});</span><span class="w">  </span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">size</span><span class="p">,</span><span class="w"> </span><span class="nx">setSize</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">({</span><span class="w"> </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="mf">100</span><span class="w"> </span><span class="p">});</span>

<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="nx">handleWindowMouseMove</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">setPosition</span><span class="p">({</span><span class="w"> </span><span class="nx">left</span><span class="o">:</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">pageX</span><span class="p">,</span><span class="w"> </span><span class="nx">top</span><span class="o">:</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">pageY</span><span class="w"> </span><span class="p">});</span><span class="w">    </span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">// ...</span>
</code></pre></div>
<p>把独立的 state 变量拆分开还有另外的好处。</p>
<p>这使得后期把一些相关的逻辑抽取到一个自定义 Hook 变得容易，比如说:</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Box</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useWindowPosition</span><span class="p">();</span><span class="w">  </span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">size</span><span class="p">,</span><span class="w"> </span><span class="nx">setSize</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">({</span><span class="w"> </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="mf">100</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">useWindowPosition</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">position</span><span class="p">,</span><span class="w"> </span><span class="nx">setPosition</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">({</span><span class="w"> </span><span class="nx">left</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">top</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">position</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>注意看我们是如何做到不改动代码就把对 <code>position</code> 这个 state 变量的 <code>useState</code> 调用和相关的 effect 移动到一个自定义 Hook 的。</p>
<p>如果所有的 state 都存在同一个对象中，想要抽取出来就比较难了。</p>
<p>把所有 state 都放在同一个 <code>useState</code> 调用中，或是每一个字段都对应一个 <code>useState</code> 调用，这两方式都能跑通。</p>
<p>当你在这两个极端之间找到平衡，然后把相关 state 组合到几个独立的 state 变量时，组件就会更加的可读。</p>
<h3 id="props-state">如何获取上一轮的 props 或 state？<a class="headerlink" href="#props-state" title="Permanent link">&para;</a></h3>
<p>在以下两种场景下，你可以能会需要获取上一轮的 props 或 state。</p>
<p>有时，你需要获取之前的 props 来 <strong>进行副作用的清理</strong>。</p>
<p>例如，你可能有这样一个副作用，依赖 <code>userId</code> props 来订阅 socket。</p>
<p>如果 <code>userId</code> 发生了变化，你需要取消 <strong>之前</strong> <code>userId</code> 的订阅，再进行后续订阅。</p>
<p>这种情况下，你无需做额外操作即可实现：</p>
<div class="highlight"><pre><span></span><code><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">ChatAPI</span><span class="p">.</span><span class="nx">subscribeToSocket</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">userId</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">ChatAPI</span><span class="p">.</span><span class="nx">unsubscribeFromSocket</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">userId</span><span class="p">);</span>
<span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">props</span><span class="p">.</span><span class="nx">userId</span><span class="p">]);</span>
</code></pre></div>
<p>在上述示例中，如果 <code>userId</code> 从 <code>3</code> 变为 <code>4</code>，<code>ChatAPI.unsubscribeFromSocket(3)</code> 将会优先运行，然后才会执行 <code>ChatAPI.subscribeToSocket(4)</code>。</p>
<p>这种情况下，你没必要获取之前的 <code>userId</code>，因为清理函数将在闭包中捕获它，</p>
<p>我们之前曾建议使用 <code>usePrevious</code> 的自定义 Hook 来保持前值。然后，我们发现大多数用例，都属于上述两种场景。</p>
<p>如果你的用例与上述两种情况不同，你可以在 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-faq.html#is-there-something-like-instance-variables">Ref 中对该值进行存储</a> 并在需要时手动更新它。注意，应避免在渲染过程中读取和更新 refs，因为这使得你组件的行为难以预测，且难以理解。</p>
<h3 id="props-state_1">为什么我会在我的函数中看到陈旧的 props 和 state ？<a class="headerlink" href="#props-state_1" title="Permanent link">&para;</a></h3>
<p>组件内部的任何函数，包括事件处理函数和 effect，都是从它被创建的那次渲染中被「看到」的。例如，考虑这样的代码：</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Example</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">count</span><span class="p">,</span><span class="w"> </span><span class="nx">setCount</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>

<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">handleAlertClick</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setTimeout</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;You clicked on: &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">count</span><span class="p">);</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="mf">3000</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
<span class="w">      </span><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">You</span><span class="w"> </span><span class="nx">clicked</span><span class="w"> </span><span class="p">{</span><span class="nx">count</span><span class="p">}</span><span class="w"> </span><span class="nx">times</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
<span class="w">      </span><span class="o">&lt;</span><span class="nx">button</span><span class="w"> </span><span class="nx">onClick</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCount</span><span class="p">(</span><span class="nx">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">)}</span><span class="o">&gt;</span>
<span class="w">        </span><span class="nx">Click</span><span class="w"> </span><span class="nx">me</span>
<span class="w">      </span><span class="o">&lt;</span><span class="err">/button&gt;</span>
<span class="w">      </span><span class="o">&lt;</span><span class="nx">button</span><span class="w"> </span><span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleAlertClick</span><span class="p">}</span><span class="o">&gt;</span>
<span class="w">        </span><span class="nx">Show</span><span class="w"> </span><span class="nx">alert</span>
<span class="w">      </span><span class="o">&lt;</span><span class="err">/button&gt;</span>
<span class="w">    </span><span class="o">&lt;</span><span class="err">/div&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>如果你先点击「Show alert」然后增加计数器的计数，那这个 alert 会显示**在你点击『Show alert』按钮时**的 <code>count</code> 变量。</p>
<p>这避免了那些因为假设 props 和 state 没有改变的代码引起问题。</p>
<p>如果你刻意地想要从某些异步回调中读取 <em>最新的</em> state，你可以用 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-faq.html#is-there-something-like-instance-variables">一个 ref</a> 来保存它，修改它，并从中读取。</p>
<p>最后，你看到陈旧的 props 和 state 的另一个可能的原因，是你使用了「依赖数组」优化但没有正确地指定所有的依赖。举个例子，如果一个 effect 指定了 <code>[]</code> 作为第二个参数，但在内部读取了 <code>someProp</code>，它会一直「看到」 <code>someProp</code> 的初始值。解决办法是要么移除依赖数组，要么修正它。 这里介绍了 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-faq.html#is-it-safe-to-omit-functions-from-the-list-of-dependencies">你该如何处理函数</a>，而这里介绍了关于如何减少 effect 的运行而不必错误的跳过依赖的 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-faq.html#what-can-i-do-if-my-effect-dependencies-change-too-often">一些常见策略</a>。</p>
<blockquote>
<p>注意</p>
<p>我们提供了一个 <a href="https://github.com/facebook/react/issues/14920"><code>exhaustive-deps</code></a> ESLint 规则作为 <a href="https://www.npmjs.com/package/eslint-plugin-react-hooks#installation"><code>eslint-plugin-react-hooks</code></a> 包的一部分。它会在依赖被错误指定时发出警告，并给出修复建议。</p>
</blockquote>
<h3 id="getderivedstatefromprops">我该如何实现 <code>getDerivedStateFromProps</code>？<a class="headerlink" href="#getderivedstatefromprops" title="Permanent link">&para;</a></h3>
<p>尽管你可能 <a href="https://zh-hans.legacy.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html">不需要它</a>，但在一些罕见的你需要用到的场景下（比如实现一个 <code>&lt;Transition&gt;</code> 组件），你可以在渲染过程中更新 state 。React 会立即退出第一次渲染并用更新后的 state 重新运行组件以避免耗费太多性能。</p>
<p>这里我们把 <code>row</code> prop 上一轮的值存在一个 state 变量中以便比较：</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">ScrollView</span><span class="p">({</span><span class="nx">row</span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">isScrollingDown</span><span class="p">,</span><span class="w"> </span><span class="nx">setIsScrollingDown</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">prevRow</span><span class="p">,</span><span class="w"> </span><span class="nx">setPrevRow</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">row</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">prevRow</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Row 自上次渲染以来发生过改变。更新 isScrollingDown。</span>
<span class="w">    </span><span class="nx">setIsScrollingDown</span><span class="p">(</span><span class="nx">prevRow</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">row</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">prevRow</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setPrevRow</span><span class="p">(</span><span class="nx">row</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="sb">`Scrolling down: </span><span class="si">${</span><span class="nx">isScrollingDown</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>初看这或许有点奇怪，但渲染期间的一次更新恰恰就是 <code>getDerivedStateFromProps</code> 一直以来的概念。</p>
<h3 id="dom">我该如何测量 DOM 节点？<a class="headerlink" href="#dom" title="Permanent link">&para;</a></h3>
<p>获取 DOM 节点的位置或是大小的基本方式是使用 <a href="https://zh-hans.legacy.reactjs.org/docs/refs-and-the-dom.html#callback-refs">callback ref</a>。</p>
<p>每当 ref 被附加到一个另一个节点，React 就会调用 callback。</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">MeasureExample</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">height</span><span class="p">,</span><span class="w"> </span><span class="nx">setHeight</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">measuredRef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">(</span><span class="nx">node</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">    </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">node</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">      </span>
<span class="w">        </span><span class="nx">setHeight</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">getBoundingClientRect</span><span class="p">().</span><span class="nx">height</span><span class="p">);</span><span class="w">    </span>
<span class="w">    </span><span class="p">}</span><span class="w">  </span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="o">&lt;&gt;</span>
<span class="w">      </span><span class="o">&lt;</span><span class="nx">h1</span><span class="w"> </span><span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">measuredRef</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Hello</span><span class="p">,</span><span class="w"> </span><span class="nx">world</span><span class="o">&lt;</span><span class="err">/h1&gt;      </span>
<span class="w">      </span><span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">The</span><span class="w"> </span><span class="nx">above</span><span class="w"> </span><span class="nx">header</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="p">{</span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">height</span><span class="p">)}</span><span class="nx">px</span><span class="w"> </span><span class="nx">tall</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
<span class="w">    </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>在这个案例中，我们没有选择使用 <code>useRef</code>，因为当 ref 是一个对象时它并不会把当前 ref 的值的 <em>变化</em> 通知到我们。使用 callback ref 可以确保 <a href="https://codesandbox.io/s/818zzk8m78">即便子组件延迟显示被测量的节点</a> (比如为了响应一次点击)，我们依然能够在父组件接收到相关的信息，以便更新测量结果。</p>
<p>注意到我们传递了 <code>[]</code> 作为 <code>useCallback</code> 的依赖列表。这确保了 ref callback 不会在再次渲染时改变，因此 React 不会在非必要的时候调用它。</p>
<p>在此示例中，当且仅当组件挂载和卸载时，callback ref 才会被调用，因为渲染的 <code>&lt;h1&gt;</code> 组件在整个重新渲染期间始终存在。如果你希望在每次组件调整大小时都收到通知，则可能需要使用 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/ResizeObserver"><code>ResizeObserver</code></a> 或基于其构建的第三方 Hook。</p>
<p>如果你愿意，你可以 <a href="https://codesandbox.io/s/m5o42082xy">把这个逻辑抽取出来作为</a> 一个可复用的 Hook:</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">MeasureExample</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">rect</span><span class="p">,</span><span class="w"> </span><span class="nx">ref</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useClientRect</span><span class="p">();</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="o">&lt;&gt;</span>
<span class="w">      </span><span class="o">&lt;</span><span class="nx">h1</span><span class="w"> </span><span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">ref</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Hello</span><span class="p">,</span><span class="w"> </span><span class="nx">world</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">rect</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">The</span><span class="w"> </span><span class="nx">above</span><span class="w"> </span><span class="nx">header</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="p">{</span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">rect</span><span class="p">.</span><span class="nx">height</span><span class="p">)}</span><span class="nx">px</span><span class="w"> </span><span class="nx">tall</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">useClientRect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">rect</span><span class="p">,</span><span class="w"> </span><span class="nx">setRect</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">(</span><span class="nx">node</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">node</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">setRect</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">getBoundingClientRect</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="nx">rect</span><span class="p">,</span><span class="w"> </span><span class="nx">ref</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="_2">性能优化<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="_3">在依赖列表中省略函数是否安全？<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>一般来说，不安全。</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Example</span><span class="p">({</span><span class="w"> </span><span class="nx">someProp</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">doSomething</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">someProp</span><span class="p">);</span><span class="w">  </span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">doSomething</span><span class="p">();</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span><span class="w"> </span><span class="c1">// 不安全（它调用的 `doSomething` 函数使用了 `someProp`）</span>
<span class="p">}</span>
</code></pre></div>
<p>要记住 effect 外部的函数使用了哪些 props 和 state 很难。这也是为什么 <strong>通常你会想要在 effect *内部* 去声明它所需要的函数。</strong> 这样就能容易的看出那个 effect 依赖了组件作用域中的哪些值：</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Example</span><span class="p">({</span><span class="w"> </span><span class="nx">someProp</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="nx">doSomething</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">someProp</span><span class="p">);</span><span class="w">    </span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">doSomething</span><span class="p">();</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">someProp</span><span class="p">]);</span><span class="w"> </span><span class="c1">// ✅ 安全（我们的 effect 仅用到了 `someProp`）</span>
<span class="p">}</span>
</code></pre></div>
<p>如果这样之后我们依然没用到组件作用域中的任何值，就可以安全地把它指定为 <code>[]</code>：</p>
<div class="highlight"><pre><span></span><code><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">doSomething</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nx">doSomething</span><span class="p">();</span>
<span class="p">},</span><span class="w"> </span><span class="p">[]);</span><span class="w"> </span><span class="c1">// ✅ 在这个例子中是安全的，因为我们没有用到组件作用域中的 *任何* 值</span>
</code></pre></div>
<p>根据你的用例，下面列举了一些其他的办法。</p>
<blockquote>
<p>注意</p>
<p>我们提供了一个 <a href="https://github.com/facebook/react/issues/14920"><code>exhaustive-deps</code></a> ESLint 规则作为 <a href="https://www.npmjs.com/package/eslint-plugin-react-hooks#installation"><code>eslint-plugin-react-hooks</code></a> 包的一部分。它会帮助你找出无法一致地处理更新的组件。</p>
</blockquote>
<p>让我们来看看这有什么关系。</p>
<p>如果你指定了一个 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-reference.html#conditionally-firing-an-effect">依赖列表</a> 作为 <code>useEffect</code>、<code>useLayoutEffect</code>、<code>useMemo</code>、<code>useCallback</code> 或 <code>useImperativeHandle</code> 的最后一个参数，它必须包含回调中的所有值，并参与 React 数据流。这就包括 props、state，以及任何由它们衍生而来的东西。</p>
<p><strong>只有</strong> 当函数（以及它所调用的函数）不引用 props、state 以及由它们衍生而来的值时，你才能放心地把它们从依赖列表中省略。下面这个案例有一个 Bug：</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">ProductPage</span><span class="p">({</span><span class="w"> </span><span class="nx">productId</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">product</span><span class="p">,</span><span class="w"> </span><span class="nx">setProduct</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>

<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fetchProduct</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;http://myapi/product/&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">productId</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// 使用了 productId prop    </span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">json</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="w">    </span><span class="nx">setProduct</span><span class="p">(</span><span class="nx">json</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fetchProduct</span><span class="p">();</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span><span class="w"> </span><span class="c1">// 无效，因为 `fetchProduct` 使用了 `productId`  // ...</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>推荐的修复方案是把那个函数移动到你的 effect *内部*</strong>。这样就能很容易的看出来你的 effect 使用了哪些 props 和 state，并确保它们都被声明了：</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">ProductPage</span><span class="p">({</span><span class="w"> </span><span class="nx">productId</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">product</span><span class="p">,</span><span class="w"> </span><span class="nx">setProduct</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>

<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 把这个函数移动到 effect 内部后，我们可以清楚地看到它用到的值。    </span>
<span class="w">    </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fetchProduct</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">      </span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;http://myapi/product/&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">productId</span><span class="p">);</span><span class="w">      </span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">json</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span><span class="w">      </span>
<span class="w">      </span><span class="nx">setProduct</span><span class="p">(</span><span class="nx">json</span><span class="p">);</span><span class="w">    </span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">fetchProduct</span><span class="p">();</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">productId</span><span class="p">]);</span><span class="w"> </span><span class="c1">// ✅ 有效，因为我们的 effect 只用到了 productId  // ...</span>
<span class="p">}</span>
</code></pre></div>
<p>这同时也允许你通过 effect 内部的局部变量来处理无序的响应：</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">ignore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w">    </span>
<span class="w">    </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fetchProduct</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;http://myapi/product/&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">productId</span><span class="p">);</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">json</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">ignore</span><span class="p">)</span><span class="w"> </span><span class="nx">setProduct</span><span class="p">(</span><span class="nx">json</span><span class="p">);</span><span class="w">    </span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">fetchProduct</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">ignore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">};</span><span class="w">  </span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">productId</span><span class="p">]);</span>
</code></pre></div>
<p>我们把这个函数移动到 effect 内部，这样它就不用出现在它的依赖列表中了。</p>
<p><strong>如果出于某些原因你 *无法* 把一个函数移动到 effect 内部，还有一些其他办法：</strong></p>
<ul>
<li><strong>你可以尝试把那个函数移动到你的组件之外</strong>。那样一来，这个函数就肯定不会依赖任何 props 或 state，并且也不用出现在依赖列表中了。</li>
<li>如果你所调用的方法是一个纯计算，并且可以在渲染时调用，你可以 <strong>转而在 effect 之外调用它，</strong> 并让 effect 依赖于它的返回值。</li>
<li>万不得已的情况下，你可以 <strong>把函数加入 effect 的依赖但 *把它的定义包裹*</strong> 进 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-reference.html#usecallback"><code>useCallback</code></a> Hook。这就确保了它不随渲染而改变，除非 <em>它自身</em> 的依赖发生了改变：</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">ProductPage</span><span class="p">({</span><span class="w"> </span><span class="nx">productId</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 用 useCallback 包裹以避免随渲染发生改变  </span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">fetchProduct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">    </span>
<span class="w">    </span><span class="c1">// ... Does something with productId ...  </span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">productId</span><span class="p">]);</span><span class="w"> </span>
<span class="w">  </span><span class="c1">// useCallback 的所有依赖都被指定了</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">ProductDetails</span><span class="w"> </span><span class="nx">fetchProduct</span><span class="o">=</span><span class="p">{</span><span class="nx">fetchProduct</span><span class="p">}</span><span class="w"> </span><span class="o">/&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">ProductDetails</span><span class="p">({</span><span class="w"> </span><span class="nx">fetchProduct</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fetchProduct</span><span class="p">();</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">fetchProduct</span><span class="p">]);</span><span class="w"> </span><span class="c1">// ✅ useEffect 的所有依赖都被指定了</span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>
<p>注意在上面的案例中，我们 <strong>需要</strong> 让函数出现在依赖列表中。这确保了 <code>ProductPage</code> 的 <code>productId</code> prop 的变化会自动触发 <code>ProductDetails</code> 的重新获取。</p>
<h3 id="effect">如果我的 effect 的依赖频繁变化，我该怎么办？<a class="headerlink" href="#effect" title="Permanent link">&para;</a></h3>
<p>有时候，你的 effect 可能会使用一些频繁变化的值。你可能会忽略依赖列表中 state，但这通常会引起 Bug：</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Counter</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">count</span><span class="p">,</span><span class="w"> </span><span class="nx">setCount</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>

<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">setInterval</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">setCount</span><span class="p">(</span><span class="nx">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// 这个 effect 依赖于 `count` state    </span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="mf">1000</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">clearInterval</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span><span class="w"> </span><span class="c1">// Bug: `count` 没有被指定为依赖</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">count</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h1&gt;;</span>
<span class="p">}</span>
</code></pre></div>
<p>传入空的依赖数组 <code>[]</code>，意味着该 hook 只在组件挂载时运行一次，并非重新渲染时。但如此会有问题，在 <code>setInterval</code> 的回调中，<code>count</code> 的值不会发生变化。因为当 effect 执行时，我们会创建一个闭包，并将 <code>count</code> 的值被保存在该闭包当中，且初值为 <code>0</code>。每隔一秒，回调就会执行 <code>setCount(0 + 1)</code>，因此，<code>count</code> 永远不会超过 1。</p>
<p>指定 <code>[count]</code> 作为依赖列表就能修复这个 Bug，但会导致每次改变发生时定时器都被重置。事实上，每个 <code>setInterval</code> 在被清除前（类似于 <code>setTimeout</code>）都会调用一次。但这并不是我们想要的。要解决这个问题，我们可以使用 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-reference.html#functional-updates"><code>setState</code> 的函数式更新形式</a>。它允许我们指定 state 该 <em>如何</em> 改变而不用引用 <em>当前</em> state：</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Counter</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">count</span><span class="p">,</span><span class="w"> </span><span class="nx">setCount</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>

<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">setInterval</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">setCount</span><span class="p">(</span><span class="nx">c</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// ✅ 在这不依赖于外部的 `count` 变量    </span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="mf">1000</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">clearInterval</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span><span class="w"> </span><span class="c1">// ✅ 我们的 effect 不使用组件作用域中的任何变量</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">count</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h1&gt;;</span>
<span class="p">}</span>
</code></pre></div>
<p>（<code>setCount</code> 函数的身份是被确保稳定的，所以可以放心的省略掉）</p>
<p>此时，<code>setInterval</code> 的回调依旧每秒调用一次，但每次 <code>setCount</code> 内部的回调取到的 <code>count</code> 是最新值（在回调中变量命名为 <code>c</code>）。</p>
<p>在一些更加复杂的场景中（比如一个 state 依赖于另一个 state），尝试用 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-reference.html#usereducer"><code>useReducer</code> Hook</a> 把 state 更新逻辑移到 effect 之外。<a href="https://adamrackis.dev/state-and-use-reducer/">这篇文章</a> 提供了一个你该如何做到这一点的案例。 <strong><code>useReducer</code> 的 <code>dispatch</code> 的身份永远是稳定的</strong> —— 即使 reducer 函数是定义在组件内部并且依赖 props。</p>
<p>万不得已的情况下，如果你想要类似 class 中的 <code>this</code> 的功能，你可以 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-faq.html#is-there-something-like-instance-variables">使用一个 ref</a> 来保存一个可变的变量。然后你就可以对它进行读写了。举个例子：</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Example</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 把最新的 props 保存在一个 ref 中 </span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">latestProps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useRef</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span><span class="w">  </span>
<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">    </span>
<span class="w">    </span><span class="nx">latestProps</span><span class="p">.</span><span class="nx">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">props</span><span class="p">;</span><span class="w">  </span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="nx">tick</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// 在任何时候读取最新的 props      </span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">latestProps</span><span class="p">.</span><span class="nx">current</span><span class="p">);</span><span class="w">    </span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">setInterval</span><span class="p">(</span><span class="nx">tick</span><span class="p">,</span><span class="w"> </span><span class="mf">1000</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">clearInterval</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span><span class="w"> </span><span class="c1">// 这个 effect 从不会重新执行}</span>
</code></pre></div>
<p>仅当你实在找不到更好办法的时候才这么做，因为依赖于变更会使得组件更难以预测。如果有某些特定的模式无法很好地转化成这样，<a href="https://github.com/facebook/react/issues/new">发起一个 issue</a> 并配上可运行的实例代码以便，我们会尽可能帮助你。</p>
<h3 id="shouldcomponentupdate">我该如何实现 <code>shouldComponentUpdate</code>?<a class="headerlink" href="#shouldcomponentupdate" title="Permanent link">&para;</a></h3>
<p>你可以用 <code>React.memo</code> 包裹一个组件来对它的 props 进行浅比较：</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">Button</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">React</span><span class="p">.</span><span class="nx">memo</span><span class="p">((</span><span class="nx">props</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 你的组件</span>
<span class="p">});</span>
</code></pre></div>
<p>这不是一个 Hook 因为它的写法和 Hook 不同。<code>React.memo</code> 等效于 <code>PureComponent</code>，但它只比较 props。（你也可以通过第二个参数指定一个自定义的比较函数来比较新旧 props。如果函数返回 true，就会跳过更新。）</p>
<p><code>React.memo</code> 不比较 state，因为没有单一的 state 对象可供比较。但你也可以让子节点变为纯组件，或者 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-faq.html#how-to-memoize-calculations">用 <code>useMemo</code> 优化每一个具体的子节点</a>。</p>
<h3 id="_4">如何记忆计算结果？<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p><a href="https://zh-hans.legacy.reactjs.org/docs/hooks-reference.html#usememo"><code>useMemo</code></a> Hook 允许你通过「记住」上一次计算结果的方式在多次渲染的之间缓存计算结果：</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">memoizedValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">computeExpensiveValue</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">),</span><span class="w"> </span><span class="p">[</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">]);</span>
</code></pre></div>
<p>这行代码会调用 <code>computeExpensiveValue(a, b)</code>。但如果依赖数组 <code>[a, b]</code> 自上次赋值以来没有改变过，<code>useMemo</code> 会跳过二次调用，只是简单复用它上一次返回的值。</p>
<p>记住，传给 <code>useMemo</code> 的函数是在渲染期间运行的。不要在其中做任何你通常不会在渲染期间做的事。举个例子，副作用属于 <code>useEffect</code>，而不是 <code>useMemo</code>。</p>
<p>**你可以把 <code>useMemo</code> 作为一种性能优化的手段，但不要把它当做一种语义上的保证。**未来，React 可能会选择「忘掉」一些之前记住的值并在下一次渲染时重新计算它们，比如为离屏组件释放内存。建议自己编写相关代码以便没有 <code>useMemo</code> 也能正常工作 —— 然后把它加入性能优化。（在某些取值必须 <em>从不</em> 被重新计算的罕见场景，你可以 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-faq.html#how-to-create-expensive-objects-lazily">惰性初始化</a> 一个 ref。）</p>
<p>方便起见，<code>useMemo</code> 也允许你跳过一次子节点的昂贵的重新渲染：</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Parent</span><span class="p">({</span><span class="w"> </span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Only re-rendered if `a` changes:</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">child1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">Child1</span><span class="w"> </span><span class="nx">a</span><span class="o">=</span><span class="p">{</span><span class="nx">a</span><span class="p">}</span><span class="w"> </span><span class="o">/&gt;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nx">a</span><span class="p">]);</span>
<span class="w">  </span><span class="c1">// Only re-rendered if `b` changes:</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">child2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useMemo</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">Child2</span><span class="w"> </span><span class="nx">b</span><span class="o">=</span><span class="p">{</span><span class="nx">b</span><span class="p">}</span><span class="w"> </span><span class="o">/&gt;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nx">b</span><span class="p">]);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="o">&lt;&gt;</span>
<span class="w">      </span><span class="p">{</span><span class="nx">child1</span><span class="p">}</span>
<span class="w">      </span><span class="p">{</span><span class="nx">child2</span><span class="p">}</span>
<span class="w">    </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>注意这种方式在循环中是无效的，因为 Hook 调用 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-rules.html">不能</a> 被放在循环中。但你可以为列表项抽取一个单独的组件，并在其中调用 <code>useMemo</code>。</p>
<h3 id="_5">如何惰性创建昂贵的对象？<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>如果依赖数组的值相同，<code>useMemo</code> 允许你 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-faq.html#how-to-memoize-calculations">记住一次昂贵的计算</a>。但是，这仅作为一种提示，并不 <em>保证</em> 计算不会重新运行。但有时候需要确保一个对象仅被创建一次。</p>
<p><strong>第一个常见的使用场景是当创建初始 state 很昂贵时：</strong></p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Table</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// ⚠️ createRows() 每次渲染都会被调用</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">rows</span><span class="p">,</span><span class="w"> </span><span class="nx">setRows</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="nx">createRows</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">count</span><span class="p">));</span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>
<p>为避免重新创建被忽略的初始 state，我们可以传一个 <strong>函数</strong> 给 <code>useState</code>：</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Table</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// ✅ createRows() 只会被调用一次</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">rows</span><span class="p">,</span><span class="w"> </span><span class="nx">setRows</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">createRows</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">count</span><span class="p">));</span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>
<p>React 只会在首次渲染时调用这个函数。参见 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-reference.html#usestate"><code>useState</code> API 参考</a>。</p>
<p>**你或许也会偶尔想要避免重新创建 <code>useRef()</code> 的初始值。**举个例子，或许你想确保某些命令式的 class 实例只被创建一次：</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Image</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// ⚠️ IntersectionObserver 在每次渲染都会被创建</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useRef</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">IntersectionObserver</span><span class="p">(</span><span class="nx">onIntersect</span><span class="p">));</span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>
<p><code>useRef</code> <strong>不会</strong> 像 <code>useState</code> 那样接受一个特殊的函数重载。相反，你可以编写你自己的函数来创建并将其设为惰性的：</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Image</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useRef</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// ✅ IntersectionObserver 只会被惰性创建一次</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">getObserver</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">ref</span><span class="p">.</span><span class="nx">current</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">ref</span><span class="p">.</span><span class="nx">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">IntersectionObserver</span><span class="p">(</span><span class="nx">onIntersect</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">ref</span><span class="p">.</span><span class="nx">current</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// 当你需要时，调用 getObserver()</span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>
<p>这避免了我们在一个对象被首次真正需要之前就创建它。如果你使用 Flow 或 TypeScript，你还可以为了方便给 <code>getObserver()</code> 一个不可为 null 的类型。</p>
<h3 id="hook_1">Hook 会因为在渲染时创建函数而变慢吗？<a class="headerlink" href="#hook_1" title="Permanent link">&para;</a></h3>
<p>不会。在现代浏览器中，闭包和类的原始性能只有在极端场景下才会有明显的差别。</p>
<p>除此之外，可以认为 Hook 的设计在某些方面更加高效：</p>
<ul>
<li>Hook 避免了 class 需要的额外开支，像是创建类实例和在构造函数中绑定事件处理器的成本。</li>
<li><strong>符合语言习惯的代码在使用 Hook 时不需要很深的组件树嵌套</strong>。这个现象在使用高阶组件、render props、和 context 的代码库中非常普遍。组件树小了，React 的工作量也随之减少。</li>
</ul>
<p>传统上认为，在 React 中使用内联函数对性能的影响，与每次渲染都传递新的回调会如何破坏子组件的 <code>shouldComponentUpdate</code> 优化有关。Hook 从三个方面解决了这个问题。</p>
<ul>
<li><a href="https://zh-hans.legacy.reactjs.org/docs/hooks-reference.html#usecallback"><code>useCallback</code></a> Hook 允许你在重新渲染之间保持对相同的回调引用以使得 <code>shouldComponentUpdate</code> 继续工作：</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">// 除非 `a` 或 `b` 改变，否则不会变</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">memoizedCallback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="nx">doSomething</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">);</span>
<span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">]);</span>
</code></pre></div>
<ul>
<li>
<p><a href="https://zh-hans.legacy.reactjs.org/docs/hooks-faq.html#how-to-memoize-calculations"><code>useMemo</code></a> Hook 使得控制具体子节点何时更新变得更容易，减少了对纯组件的需要。</p>
</li>
<li>
<p>最后，<a href="https://zh-hans.legacy.reactjs.org/docs/hooks-reference.html#usereducer"><code>useReducer</code></a> Hook 减少了对深层传递回调的依赖，正如下面解释的那样。</p>
</li>
</ul>
<h3 id="_6">如何避免向下传递回调？<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>我们已经发现大部分人并不喜欢在组件树的每一层手动传递回调。尽管这种写法更明确，但这给人感觉像错综复杂的管道工程一样麻烦。</p>
<p>在大型的组件树中，我们推荐的替代方案是通过 context 用 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-reference.html#usereducer"><code>useReducer</code></a> 往下传一个 <code>dispatch</code> 函数：</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">TodosDispatch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">React</span><span class="p">.</span><span class="nx">createContext</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">TodosApp</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 提示：`dispatch` 不会在重新渲染之间变化  const [todos, dispatch] = useReducer(todosReducer);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="o">&lt;</span><span class="nx">TodosDispatch</span><span class="p">.</span><span class="nx">Provider</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">dispatch</span><span class="p">}</span><span class="o">&gt;</span>
<span class="w">      </span><span class="o">&lt;</span><span class="nx">DeepTree</span><span class="w"> </span><span class="nx">todos</span><span class="o">=</span><span class="p">{</span><span class="nx">todos</span><span class="p">}</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">    </span><span class="o">&lt;</span><span class="err">/TodosDispatch.Provider&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p><code>TodosApp</code> 内部组件树里的任何子节点都可以使用 <code>dispatch</code> 函数来向上传递 actions 到 <code>TodosApp</code>：</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">DeepChild</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// 如果我们想要执行一个 action，我们可以从 context 中获取 dispatch。  const dispatch = useContext(TodosDispatch);</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">handleClick</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">dispatch</span><span class="p">({</span><span class="w"> </span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;add&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;hello&#39;</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="o">&lt;</span><span class="nx">button</span><span class="w"> </span><span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Add</span><span class="w"> </span><span class="nx">todo</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>总而言之，从维护的角度来这样看更加方便（不用不断转发回调），同时也避免了回调的问题。像这样向下传递 <code>dispatch</code> 是处理深度更新的推荐模式。</p>
<p>注意，你依然可以选择将应用的 <em>state</em> 作为 props（更显明确）向下传递或者使用 context（对很深的更新而言更加方便）向下传递。如果你选择使用 context 来向下传递 state，请使用两种不同的 context 类型传递 state 和 dispatch —— 由于 <code>dispatch</code> context 永远不会变，因此读取它的组件不需要重新渲染，除非这些组件也需要用到应用程序的 state。</p>
<h3 id="usecallback">如何从 <code>useCallback</code> 读取一个经常变化的值？<a class="headerlink" href="#usecallback" title="Permanent link">&para;</a></h3>
<blockquote>
<p>注意</p>
<p>我们推荐 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-faq.html#how-to-avoid-passing-callbacks-down">在 context 中向下传递 <code>dispatch</code></a> 而非在 props 中使用独立的回调。下面的方法仅仅出于文档完整性考虑，以及作为一条出路在此提及。</p>
</blockquote>
<p>在某些罕见场景中，你可能会需要用 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-reference.html#usecallback"><code>useCallback</code></a> 记住一个回调，但由于内部函数必须经常重新创建，记忆效果不是很好。如果你想要记住的函数是一个事件处理器并且在渲染期间没有被用到，你可以 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-faq.html#is-there-something-like-instance-variables">把 ref 当做实例变量</a> 来用，并手动把最后提交的值保存在它当中：</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Form</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">text</span><span class="p">,</span><span class="w"> </span><span class="nx">updateText</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">textRef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useRef</span><span class="p">();</span>

<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">textRef</span><span class="p">.</span><span class="nx">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">text</span><span class="p">;</span><span class="w"> </span><span class="c1">// 把它写入 ref  });</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleSubmit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">currentText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">textRef</span><span class="p">.</span><span class="nx">current</span><span class="p">;</span><span class="w"> </span><span class="c1">// 从 ref 读取它    alert(currentText);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">textRef</span><span class="p">]);</span><span class="w"> </span><span class="c1">// 不要像 [text] 那样重新创建 handleSubmit</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="o">&lt;&gt;</span>
<span class="w">      </span><span class="o">&lt;</span><span class="nx">input</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">text</span><span class="p">}</span><span class="w"> </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="nx">e</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">updateText</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">      </span><span class="o">&lt;</span><span class="nx">ExpensiveTree</span><span class="w"> </span><span class="nx">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="nx">handleSubmit</span><span class="p">}</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">    </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>这是一个比较麻烦的模式，但这表示如果你需要的话你可以用这条出路进行优化。如果你把它抽取成一个自定义 Hook 的话会更加好受些：</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Form</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">text</span><span class="p">,</span><span class="w"> </span><span class="nx">updateText</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// 即便 `text` 变了也会被记住:</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleSubmit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useEventCallback</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">    </span><span class="nx">alert</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">text</span><span class="p">]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="o">&lt;&gt;</span>
<span class="w">      </span><span class="o">&lt;</span><span class="nx">input</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">text</span><span class="p">}</span><span class="w"> </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="nx">e</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">updateText</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">      </span><span class="o">&lt;</span><span class="nx">ExpensiveTree</span><span class="w"> </span><span class="nx">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="nx">handleSubmit</span><span class="p">}</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">    </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">  </span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">useEventCallback</span><span class="p">(</span><span class="nx">fn</span><span class="p">,</span><span class="w"> </span><span class="nx">dependencies</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useRef</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;Cannot call an event handler while rendering.&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ref</span><span class="p">.</span><span class="nx">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fn</span><span class="p">;</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">fn</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">dependencies</span><span class="p">]);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">useCallback</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ref</span><span class="p">.</span><span class="nx">current</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">fn</span><span class="p">();</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">ref</span><span class="p">]);</span>
<span class="p">}</span>
</code></pre></div>
<p>无论如何，我们都 <strong>不推荐使用这种模式</strong> ，只是为了文档的完整性而把它展示在这里。相反的，我们更倾向于 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-faq.html#how-to-avoid-passing-callbacks-down">避免向下深入传递回调</a>。</p>
<h2 id="_7">底层原理<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<h3 id="react-hook">React 是如何把对 Hook 的调用和组件联系起来的？<a class="headerlink" href="#react-hook" title="Permanent link">&para;</a></h3>
<p>React 保持对当前渲染中的组件的追踪。多亏了 <a href="https://zh-hans.legacy.reactjs.org/docs/hooks-rules.html">Hook 规范</a>，我们得知 Hook 只会在 React 组件中被调用（或自定义 Hook —— 同样只会在 React 组件中被调用）。</p>
<p>每个组件内部都有一个「记忆单元格」列表。它们只不过是我们用来存储一些数据的 JavaScript 对象。当你用 <code>useState()</code> 调用一个 Hook 的时候，它会读取当前的单元格（或在首次渲染时将其初始化），然后把指针移动到下一个。这就是多个 <code>useState()</code> 调用会得到各自独立的本地 state 的原因。</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">July 29, 2025</span>
  </span>

    
    
    
      
  
  <span class="md-source-file__fact">
    <span class="md-icon" title="Contributors">
      
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 4a4 4 0 0 1 4 4 4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4"/></svg>
      
    </span>
    <nav>
      
        <a href="mailto:1822852997@qq.com">Michael An</a>
    </nav>
  </span>

    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; Michael An
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../js/baidu-statistics.min.js"></script>
      
        <script src="../../js/history.min.js"></script>
      
    
  </body>
</html>