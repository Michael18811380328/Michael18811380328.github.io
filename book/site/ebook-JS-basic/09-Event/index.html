
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <meta name="author" content="Michael An">
      
      
        <link rel="canonical" href="https://michael18811380328.github.io/ebook-JS-basic/09-Event/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.4">
    
    
      
        <title>09-Event - Michale An Blog</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.f7f47774.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Michale An Blog" class="md-header__button md-logo" aria-label="Michale An Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Michale An Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              09-Event
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/Michael18811380328/Michael18811380328.github.io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Michael18811380328/Michael18811380328.github.io
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Michale An Blog" class="md-nav__button md-logo" aria-label="Michale An Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Michale An Blog
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/Michael18811380328/Michael18811380328.github.io/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Michael18811380328/Michael18811380328.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        人生思考
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="人生思考" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          人生思考
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        说明
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/40%E9%80%80%E4%BC%91/" class="md-nav__link">
        40退休
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/JS%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" class="md-nav__link">
        JS 数据结构
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/Poor-and-busy/" class="md-nav__link">
        Poor-and-busy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/Reflections%20on%20Pre-Tirement/" class="md-nav__link">
        Reflections on Pre-Tirement
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/The%20art%20of%20Execution%20%E6%89%A7%E8%A1%8C%E5%8A%9B%E7%9A%84%E8%89%BA%E6%9C%AF/" class="md-nav__link">
        The art of Execution 执行力的艺术
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/Who%20Wants%20to%20Be%20a%20Millionaire/" class="md-nav__link">
        Who Wants to Be a Millionaire
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/b%E8%AE%A1%E5%88%92/" class="md-nav__link">
        b计划
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/data%20structure%20basic/" class="md-nav__link">
        data structure basic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/" class="md-nav__link">
        index
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/leanpub-auto-the-road-to-ecmascript-6/" class="md-nav__link">
        leanpub-auto-the-road-to-ecmascript-6
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/%E7%86%B5%E5%A2%9E/" class="md-nav__link">
        熵增
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/%E4%B8%AA%E4%BA%BA%E9%80%89%E6%8B%A9/" class="md-nav__link">
        个人选择
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/%E4%BA%BA%E7%94%9F%E7%9C%9F%E7%9B%B8/" class="md-nav__link">
        人生真相
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/%E5%85%B6%E4%BB%96%E4%B9%A6%E5%8D%95/" class="md-nav__link">
        其他书单
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/%E4%B8%B9%E5%B0%BC%E6%96%AF%E4%B8%8EUnix/" class="md-nav__link">
        丹尼斯与Unix
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/%E8%A9%B9%E5%AE%8F%E5%BF%97%E8%AF%BB%E4%B9%A6/" class="md-nav__link">
        詹宏志读书
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/%E9%AA%A1%E5%AD%90%E5%92%8C%E4%BA%BA%E7%94%9F/" class="md-nav__link">
        骡子和人生
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/%E4%BB%A3%E7%A0%81%E6%95%B4%E6%B4%81%E4%B9%8B%E9%81%93%20%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        代码整洁之道 读书笔记
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/%E5%A6%82%E4%BD%95%E5%8F%98%E5%BE%97%E5%BC%BA%E5%A4%A7/" class="md-nav__link">
        如何变得强大
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/%E4%B8%93%E4%B8%9A%E6%95%99%E8%82%B2%E7%9A%84%E5%85%B4%E8%B5%B7/" class="md-nav__link">
        专业教育的兴起
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/%E4%B8%AD%E5%9B%BD%E7%BB%8F%E6%B5%8E%E7%9A%84%E8%BD%AC%E5%8F%98/" class="md-nav__link">
        中国经济的转变
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/%E7%A1%95%E5%A3%AB%E5%AD%A6%E4%BD%8D%E7%9A%84%E8%B4%AC%E5%80%BC/" class="md-nav__link">
        硕士学位的贬值
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/%E4%BB%BB%E6%AD%A3%E9%9D%9E%E7%9A%84%E7%AE%A1%E7%90%86%E6%80%9D%E6%83%B3/" class="md-nav__link">
        任正非的管理思想
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/%E6%8A%80%E6%9C%AF%E5%92%8C%E7%A8%B3%E5%AE%9A%E7%9A%84%E5%B7%A5%E4%BD%9C/" class="md-nav__link">
        技术和稳定的工作
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/%E5%A4%A7%E5%AD%A6%E6%95%99%E8%82%B2%E5%92%8C%E7%BD%91%E7%BB%9C%E6%96%87%E5%87%AD/" class="md-nav__link">
        大学教育和网络文凭
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE%E5%88%B0%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" class="md-nav__link">
        思维导图到深度学习
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/%E4%B8%AD%E5%9B%BD%E7%9A%84%E6%88%BF%E4%BB%B7%E4%BC%9A%E6%80%8E%E4%B9%88%E6%94%B6%E5%9C%BA/" class="md-nav__link">
        中国的房价会怎么收场
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/%E5%B7%A5%E4%B8%9A%E6%96%87%E6%98%8E%E5%AF%B9%E4%BA%8E%E7%A4%BE%E4%BC%9A%E7%9A%84%E5%86%B2%E5%87%BB/" class="md-nav__link">
        工业文明对于社会的冲击
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../other/%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83%E5%92%8C%E5%AF%B9%E6%95%B0%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83/" class="md-nav__link">
        正态分布和对数正态分布
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        JS 基础
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="JS 基础" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          JS 基础
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../01-%E5%85%A5%E9%97%A8/" class="md-nav__link">
        01-入门
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../02-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" class="md-nav__link">
        02-数据类型
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../03-%E8%BF%90%E7%AE%97%E7%AC%A6/" class="md-nav__link">
        03-运算符
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../04-%E8%AF%AD%E6%B3%95%E4%B8%93%E9%A2%98/" class="md-nav__link">
        04-语法专题
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E6%A0%87%E5%87%86%E5%BA%93/" class="md-nav__link">
        05-标准库
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../06-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B/" class="md-nav__link">
        06-面向对象编程
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../07-%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C/" class="md-nav__link">
        07-异步操作
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../08-DOM/" class="md-nav__link">
        08-DOM
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          09-Event
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        09-Event
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    第九章 事件
  </a>
  
    <nav class="md-nav" aria-label="第九章 事件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91" class="md-nav__link">
    9.1 事件对象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92" class="md-nav__link">
    9.2 事件模型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#93" class="md-nav__link">
    9.3 事件对象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#94" class="md-nav__link">
    9.4 鼠标事件
  </a>
  
    <nav class="md-nav" aria-label="9.4 鼠标事件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    滚轮事件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#95" class="md-nav__link">
    9.5 键盘事件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#96" class="md-nav__link">
    9.6进度事件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#97" class="md-nav__link">
    9.7 表单事件
  </a>
  
    <nav class="md-nav" aria-label="9.7 表单事件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input" class="md-nav__link">
    input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select" class="md-nav__link">
    select
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change" class="md-nav__link">
    change
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#invalid" class="md-nav__link">
    invalid
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reset-submit" class="md-nav__link">
    reset submit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    构造函数
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#98" class="md-nav__link">
    9.8 触摸事件
  </a>
  
    <nav class="md-nav" aria-label="9.8 触摸事件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#touch" class="md-nav__link">
    Touch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#touchlist" class="md-nav__link">
    TouchList
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#touchevent" class="md-nav__link">
    TouchEvent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#touchevent_1" class="md-nav__link">
    TouchEvent 分类
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#99" class="md-nav__link">
    9.9 拖拽事件
  </a>
  
    <nav class="md-nav" aria-label="9.9 拖拽事件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1.拖拽对象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2.拖拽事件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3.拖拽实例
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-datatransfer" class="md-nav__link">
    4、数据传输器 dataTransfer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5、数据传输器的属性
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6、数据传输器的方法
  </a>
  
    <nav class="md-nav" aria-label="6、数据传输器的方法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1setdata" class="md-nav__link">
    1、setdata 用来设置拖拉事件所带有的数据
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2datatransfergetdata" class="md-nav__link">
    2、DataTransfer.getData()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3datatransfercleardata" class="md-nav__link">
    3、DataTransfer.clearData()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4datatransfersetdragimage" class="md-nav__link">
    4、DataTransfer.setDragImage()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#910" class="md-nav__link">
    9.10 其他事件
  </a>
  
    <nav class="md-nav" aria-label="9.10 其他事件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1beforeunload" class="md-nav__link">
    1、beforeUnload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2unload" class="md-nav__link">
    2、unload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3load-error-abort" class="md-nav__link">
    3、load error abort
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4pageshow-pagehide" class="md-nav__link">
    4、pageshow pagehide
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5popstate" class="md-nav__link">
    5、popstate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6hashchange" class="md-nav__link">
    6、hashchange
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7domcontentloaded" class="md-nav__link">
    7、DOMContentLoaded
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8readystatechange" class="md-nav__link">
    8、readystatechange
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9scroll" class="md-nav__link">
    9、scroll
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10resize" class="md-nav__link">
    10、resize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11fullscreenchange-fullscreenerror" class="md-nav__link">
    11、fullscreenchange fullscreenerror
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    12、剪切板事件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    13、焦点事件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14customevent" class="md-nav__link">
    14、CustomEvent
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#911-api" class="md-nav__link">
    9.11 全局事件处理API
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../10-BOM/" class="md-nav__link">
        10-BOM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../11-%E7%BD%91%E9%A1%B5%E5%85%83%E7%B4%A0%E6%8E%A5%E5%8F%A3/" class="md-nav__link">
        11-网页元素接口
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../readme/" class="md-nav__link">
        readme
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        网易云课堂笔记
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="网易云课堂笔记" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          网易云课堂笔记
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/02-v8%E5%BC%95%E6%93%8E%E5%9B%9E%E6%94%B6%E5%86%85%E5%AD%98%E7%AE%80%E4%BB%8B/" class="md-nav__link">
        02-v8引擎回收内存简介
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/03-node%E4%B8%8B%E9%9D%A2%E7%9A%84Restful%E5%AE%9E%E7%8E%B0/" class="md-nav__link">
        03-node下面的Restful实现
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/04-%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3%E7%9A%84%E6%8F%90%E5%8D%87%E2%80%94%E5%A6%82%E4%BD%95%E6%8F%90%E9%AB%98%E6%88%91%E4%BB%AC%E4%BB%A3%E7%A0%81%E7%9A%84%E5%8F%AF%E6%89%A9%E5%B1%95%E6%80%A7/" class="md-nav__link">
        04-编程思想的提升—如何提高我们代码的可扩展性
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/06-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%B8%B2%E6%9F%93%E5%8E%9F%E7%90%86%E5%92%8Cssr/" class="md-nav__link">
        06-浏览器渲染原理和ssr
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/07-%E7%BD%91%E6%98%93%E7%9C%9F%E5%AE%9E%E9%A1%B9%E7%9B%AEwebpack%E9%85%8D%E7%BD%AE%E8%A7%A3%E6%9E%90/" class="md-nav__link">
        07-网易真实项目webpack配置解析
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/08-%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%88%86%E6%9E%90API%E5%B1%82/" class="md-nav__link">
        08-从架构分析API层
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/09-%E5%89%8D%E7%AB%AF%E8%B4%9F%E8%B4%A3%E4%BA%BA%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%86%85%E5%AE%B9/" class="md-nav__link">
        09-前端负责人的工作内容
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/10-%E5%88%86%E6%9E%90%E6%BA%90%E7%A0%81%E5%AD%A6%E6%9E%B6%E6%9E%84/" class="md-nav__link">
        10-分析源码学架构
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/11-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E9%AB%98%E8%B4%A8%E9%87%8F%E4%BB%A3%E7%A0%81/" class="md-nav__link">
        11-设计模式高质量代码
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/12-nodeJS%2BMongoDB%E7%99%BB%E5%BD%95%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        12-nodeJS+MongoDB登录系统
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/12-nodejs-mongodb-mongoose/" class="md-nav__link">
        12-nodejs-mongodb-mongoose
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/13-%E4%BD%BF%E7%94%A8VUE%E5%88%9B%E5%BB%BA%E7%BB%84%E4%BB%B6%EF%BC%88%E6%B2%A1%E5%AD%A6%E5%AE%8C%EF%BC%89/" class="md-nav__link">
        13-使用VUE创建组件（没学完）
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/16-%E6%9E%84%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E8%84%9A%E6%89%8B%E6%9E%B6%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        16-构建自己的脚手架工具
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/17-webpack%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/" class="md-nav__link">
        17-webpack编译原理分析
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/20-%E7%BB%84%E4%BB%B6%E5%B0%81%E8%A3%85%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%8A%80%E8%83%BD-VUE%EF%BC%88%E6%B2%A1%E5%AD%A6%E5%AE%8C%EF%BC%89/" class="md-nav__link">
        20-组件封装的基本技能-VUE（没学完）
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/21-ssr/" class="md-nav__link">
        21-ssr
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/24-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E5%A6%82%E4%BD%95%E5%81%9A/" class="md-nav__link">
        24-单元测试如何做
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/25-%E5%9F%BA%E4%BA%8ENodeJS%E6%89%93%E9%80%A0Web%E6%9E%B6%E6%9E%84%E4%B8%AD%E9%97%B4%E5%B1%82/" class="md-nav__link">
        25-基于NodeJS打造Web架构中间层
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/26-webpack%E7%9A%84%E9%AB%98%E7%BA%A7%E6%8A%80%E5%B7%A7/" class="md-nav__link">
        26-webpack的高级技巧
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-netease-senior-frontend/readme/" class="md-nav__link">
        readme
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        开课吧笔记
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="开课吧笔记" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          开课吧笔记
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-kaikeba-frontend/01%20%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" class="md-nav__link">
        01 性能优化
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-kaikeba-frontend/02%20%E5%89%8D%E7%AB%AF%E6%B5%8B%E8%AF%95/" class="md-nav__link">
        02 前端测试
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-kaikeba-frontend/03%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" class="md-nav__link">
        03 设计模式
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-kaikeba-frontend/04%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" class="md-nav__link">
        04 数据结构与算法
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-kaikeba-frontend/05%20%E9%9D%A2%E8%AF%95%E9%A2%98/" class="md-nav__link">
        05 面试题
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-kaikeba-frontend/06%20%E9%9D%A2%E8%AF%95%E6%8A%80%E5%B7%A7/" class="md-nav__link">
        06 面试技巧
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        前端工程化笔记
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="前端工程化笔记" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          前端工程化笔记
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-jstraining-RYF/" class="md-nav__link">
        README
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-jstraining-RYF/engineering/" class="md-nav__link">
        engineering
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-jstraining-RYF/history/" class="md-nav__link">
        history
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-jstraining-RYF/node/" class="md-nav__link">
        node
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-jstraining-RYF/preparation/" class="md-nav__link">
        preparation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-jstraining-RYF/react/" class="md-nav__link">
        react
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        JS ES6 语法
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="JS ES6 语法" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          JS ES6 语法
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/readme/" class="md-nav__link">
        说明
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/01-%E4%BB%8B%E7%BB%8D/" class="md-nav__link">
        01-介绍
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/02-%E5%8F%98%E9%87%8F%E8%B5%8B%E5%80%BC/" class="md-nav__link">
        02-变量赋值
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/03-%E8%A7%A3%E6%9E%84%E8%B5%8B%E5%80%BC/" class="md-nav__link">
        03-解构赋值
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/04-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%89%A9%E5%B1%95/" class="md-nav__link">
        04-字符串的扩展
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/05-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%96%B9%E6%B3%95/" class="md-nav__link">
        05-字符串方法
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/06-%E6%AD%A3%E5%88%99/" class="md-nav__link">
        06-正则
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/07-%E6%95%B0%E5%80%BC/" class="md-nav__link">
        07-数值
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/08-%E5%87%BD%E6%95%B0/" class="md-nav__link">
        08-函数
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/09-%E6%95%B0%E7%BB%84/" class="md-nav__link">
        09-数组
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/10-%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%96%B0%E5%A2%9E%E5%B1%9E%E6%80%A7/" class="md-nav__link">
        10-对象的新增属性
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/11-%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%96%B0%E5%A2%9E%E6%96%B9%E6%B3%95/" class="md-nav__link">
        11-对象的新增方法
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/12-Symbol/" class="md-nav__link">
        12-Symbol
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/13-Set%20%E5%92%8C%20Map%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" class="md-nav__link">
        13-Set 和 Map 数据结构
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/14-Proxy/" class="md-nav__link">
        14-Proxy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/15-Reflect/" class="md-nav__link">
        15-Reflect
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/16-Promise/" class="md-nav__link">
        16-Promise
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/17-%E9%81%8D%E5%8E%86%E5%99%A8%E7%9A%84%E5%BE%AA%E7%8E%AF/" class="md-nav__link">
        17-遍历器的循环
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/18-Generator/" class="md-nav__link">
        18-Generator
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/19-Generator%E5%BC%82%E6%AD%A5%E5%BA%94%E7%94%A8/" class="md-nav__link">
        19-Generator异步应用
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/20-async%20%E5%87%BD%E6%95%B0/" class="md-nav__link">
        20-async 函数
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/21-Class%20%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/" class="md-nav__link">
        21-Class 的基本语法
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/22-Class%20%E7%9A%84%E7%BB%A7%E6%89%BF/" class="md-nav__link">
        22-Class 的继承
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/23-Module%20%E7%9A%84%E8%AF%AD%E6%B3%95/" class="md-nav__link">
        23-Module 的语法
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/24-Module%20%E7%9A%84%E5%8A%A0%E8%BD%BD%E5%AE%9E%E7%8E%B0/" class="md-nav__link">
        24-Module 的加载实现
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-JSES6-RYF/25-%E7%BC%96%E7%A8%8B%E9%A3%8E%E6%A0%BC/" class="md-nav__link">
        25-编程风格
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Javascript 高级教程
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Javascript 高级教程" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Javascript 高级教程
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../book-JS-primer-code-design/08-window/" class="md-nav__link">
        08-window
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../book-JS-primer-code-design/10-nodes/" class="md-nav__link">
        10-nodes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../book-JS-primer-code-design/11-choose/" class="md-nav__link">
        11-choose
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../book-JS-primer-code-design/22-%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95/" class="md-nav__link">
        22-高级用法
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../book-JS-primer-code-design/24-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/" class="md-nav__link">
        24-最佳实践
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../book-JS-primer-code-design/readme/" class="md-nav__link">
        readme
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        其他书籍
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="其他书籍" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          其他书籍
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../book-JS-The-good-parts/JS-the-good-parts/" class="md-nav__link">
        JS-the-good-parts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../book-JS-The-good-parts/curry-function/" class="md-nav__link">
        curry-function
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ebook-javascript-secret-garden/JavaScript%20%E7%A7%98%E5%AF%86%E8%8A%B1%E5%9B%AD-zh/" class="md-nav__link">
        JavaScript 秘密花园
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    第九章 事件
  </a>
  
    <nav class="md-nav" aria-label="第九章 事件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91" class="md-nav__link">
    9.1 事件对象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92" class="md-nav__link">
    9.2 事件模型
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#93" class="md-nav__link">
    9.3 事件对象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#94" class="md-nav__link">
    9.4 鼠标事件
  </a>
  
    <nav class="md-nav" aria-label="9.4 鼠标事件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    滚轮事件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#95" class="md-nav__link">
    9.5 键盘事件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#96" class="md-nav__link">
    9.6进度事件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#97" class="md-nav__link">
    9.7 表单事件
  </a>
  
    <nav class="md-nav" aria-label="9.7 表单事件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input" class="md-nav__link">
    input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select" class="md-nav__link">
    select
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change" class="md-nav__link">
    change
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#invalid" class="md-nav__link">
    invalid
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reset-submit" class="md-nav__link">
    reset submit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    构造函数
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#98" class="md-nav__link">
    9.8 触摸事件
  </a>
  
    <nav class="md-nav" aria-label="9.8 触摸事件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#touch" class="md-nav__link">
    Touch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#touchlist" class="md-nav__link">
    TouchList
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#touchevent" class="md-nav__link">
    TouchEvent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#touchevent_1" class="md-nav__link">
    TouchEvent 分类
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#99" class="md-nav__link">
    9.9 拖拽事件
  </a>
  
    <nav class="md-nav" aria-label="9.9 拖拽事件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1.拖拽对象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2.拖拽事件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3.拖拽实例
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-datatransfer" class="md-nav__link">
    4、数据传输器 dataTransfer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5、数据传输器的属性
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6、数据传输器的方法
  </a>
  
    <nav class="md-nav" aria-label="6、数据传输器的方法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1setdata" class="md-nav__link">
    1、setdata 用来设置拖拉事件所带有的数据
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2datatransfergetdata" class="md-nav__link">
    2、DataTransfer.getData()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3datatransfercleardata" class="md-nav__link">
    3、DataTransfer.clearData()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4datatransfersetdragimage" class="md-nav__link">
    4、DataTransfer.setDragImage()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#910" class="md-nav__link">
    9.10 其他事件
  </a>
  
    <nav class="md-nav" aria-label="9.10 其他事件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1beforeunload" class="md-nav__link">
    1、beforeUnload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2unload" class="md-nav__link">
    2、unload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3load-error-abort" class="md-nav__link">
    3、load error abort
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4pageshow-pagehide" class="md-nav__link">
    4、pageshow pagehide
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5popstate" class="md-nav__link">
    5、popstate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6hashchange" class="md-nav__link">
    6、hashchange
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7domcontentloaded" class="md-nav__link">
    7、DOMContentLoaded
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8readystatechange" class="md-nav__link">
    8、readystatechange
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9scroll" class="md-nav__link">
    9、scroll
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10resize" class="md-nav__link">
    10、resize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11fullscreenchange-fullscreenerror" class="md-nav__link">
    11、fullscreenchange fullscreenerror
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    12、剪切板事件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    13、焦点事件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14customevent" class="md-nav__link">
    14、CustomEvent
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#911-api" class="md-nav__link">
    9.11 全局事件处理API
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Michael18811380328/Michael18811380328.github.io/edit/master/docs/ebook-JS-basic/09-Event.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>09-Event</h1>
                
                <h2 id="_1">第九章 事件<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h3 id="91">9.1 事件对象<a class="headerlink" href="#91" title="Permanent link">&para;</a></h3>
<p>事件是组件间通信的方式之一，可以用来异步编程，有三个方法：</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span> <span class="nx">handleEvent</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// 事件触发函数执行</span>
<span class="p">}</span>
<span class="nx">div</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;onclick&#39;</span><span class="p">,</span> <span class="nx">handleEvent</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="c1">// 增加事件监听；第一个参数是事假类型，对大小写很敏感，第二个是事件处理函数，可以使匿名函数或者外部函数，第三个可选参数是监听事件的阶段。默认是false，表示在事件冒泡阶段监听事件；true 表示在事件捕获阶段监听。无返回值。第二个参数可以使事件处理函数，还可以是 handleEvent 的方法对象 {handleEvent: function(e){...}}。第三个参数还可以配置{once: true} 表示函数只监听一次事件，之后自动移除。一个对象上绑定不同的监听函数，那么触发按照先后顺序进行；如果绑定多个相同的监听函数，那么只触发一次。</span>

<span class="nx">div</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s1">&#39;onclick&#39;</span><span class="p">,</span> <span class="nx">handleEvent</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="nx">移除事件监听</span><span class="err">：</span><span class="nx">这里的三个参数必须相同</span><span class="err">，</span><span class="nx">才能移除事件监听</span><span class="err">。</span>

<span class="kd">let</span> <span class="nx">e</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Event</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">);</span>
<span class="nx">div</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
<span class="nx">事件派发</span><span class="p">(</span><span class="nx">触发</span><span class="p">)</span><span class="err">，</span><span class="nx">创建一个事件并触发</span><span class="err">。</span><span class="nx">如果不传参数会报错</span>
</code></pre></div>
<h3 id="92">9.2 事件模型<a class="headerlink" href="#92" title="Permanent link">&para;</a></h3>
<p><strong>监听函数</strong>：事件发生后，浏览器监测到事件，触发监听函数，事件驱动编程模式（event-drived）绑定监听函数有三个方法：</p>
<ul>
<li>
<p>on 行内绑定： <code>&lt;div onclick={(e) =&gt; {console.log(e);}&gt;&lt;/div&gt;</code> 这个在事件冒泡阶段执行（子元素先触发事件，之后冒泡到父元素），一个事件对应一个执行语句。JS和HTML混合不好。</p>
</li>
<li>
<p>on 节点绑定：效果和第一个相同，监听函数内容可以增多，适应于绑定事件很少代码。如果两次绑定会覆盖</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{...}</span>
<span class="nx">div</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{...}</span>
</code></pre></div>
<ul>
<li>addEventListener 绑定事件。一个事件可以添加多个函数，适应于多个事件，可以解绑事件监听。</li>
</ul>
<p>监听函数内部的this指向触发事件的DOM元素，通常使用 event.target.value 获取DOM元素的值。</p>
<p>**事件传播：**事件经历三个阶段：事件捕获阶段（上到下）事件目标阶段（底层触发）事件冒泡阶段（下到上）</p>
<p><strong>事件代理</strong>：事件从下层向上层冒泡，所以可以在上层设置事件监听，统一监听下层的事件变化，如果下层的节点个数变化不会影响上层事件的监听。这样可以很方便的处理多事件，多子节点，子节点变化的情况。</p>
<p><strong>阻止事件冒泡</strong>：stopPropogation，这个方法可以阻止事件传播（向上向下传播），但是不能阻止事件的触发（如果事件对应两个监听函数，第一个阻止事件冒泡，第二个函数仍然可以触发）。如果使用 stopImmediatePropogation 可以阻止后面函数的触发。</p>
<h3 id="93">9.3 事件对象<a class="headerlink" href="#93" title="Permanent link">&para;</a></h3>
<p>Event 对象（由Event构造函数创建）是原生对象，Event实例继承自这个对象，所以可以创建一个新对象</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span> <span class="nx">e</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Event</span><span class="p">(</span><span class="s1">&#39;look&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;bubbles&#39;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="s1">&#39;cancelable&#39;</span><span class="o">:</span> <span class="kc">false</span><span class="p">});</span>
<span class="c1">// 第一个参数是事件名称(可以自定义)</span>
<span class="c1">// 第二个参数是属性：可以向上冒泡，事件不可以被取消</span>
</code></pre></div>
<p>属性</p>
<div class="highlight"><pre><span></span><code><span class="nx">e</span><span class="p">.</span><span class="nx">bubbles</span> <span class="nx">事件是否可以冒泡</span><span class="p">(</span><span class="nx">默认不会冒泡</span><span class="err">，</span><span class="nx">除非显示声明</span><span class="p">)</span>
<span class="nx">e</span><span class="p">.</span><span class="nx">eventPhase</span> <span class="nx">事件处于什么阶段</span><span class="p">(</span><span class="mf">0</span><span class="o">-</span><span class="mf">3</span><span class="p">)</span> <span class="nx">对应没有触发</span><span class="err">、</span><span class="nx">事件捕获</span><span class="err">、</span><span class="nx">目标阶段</span><span class="err">、</span><span class="nx">事件冒泡</span>
<span class="nx">e</span><span class="p">.</span><span class="nx">cancelable</span> <span class="nx">返回布尔值</span><span class="err">，</span><span class="nx">判断事件可以被取消</span><span class="err">，</span><span class="nx">如果是false</span><span class="err">，</span><span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span> <span class="nx">是无效的</span><span class="err">，</span><span class="nx">对于不确定的事情可以先判断</span><span class="err">，</span><span class="nx">后确定是否阻止默认事件</span><span class="err">。</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">cancelable</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
<span class="p">}</span>
<span class="nx">e</span><span class="p">.</span><span class="nx">cancleBubblt</span> <span class="o">===</span> <span class="kc">true</span> <span class="nx">时</span><span class="err">，</span><span class="nx">类似于</span> <span class="nx">e</span><span class="p">.</span><span class="nx">cancleBubble</span><span class="p">()</span> <span class="nx">方法</span><span class="err">，</span><span class="nx">可以阻止事件冒泡</span><span class="err">。</span>
<span class="nx">e</span><span class="p">.</span><span class="nx">defaultPrevented</span> <span class="nx">判断事件是否执行过</span> <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span>
<span class="nx">e</span><span class="p">.</span><span class="nx">target</span> <span class="nx">事件原始触发的节点</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span>
<span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span> <span class="nx">事件正在经过的节点</span><span class="p">(</span><span class="nx">input触发后</span><span class="err">，</span><span class="nx">事件冒泡到上层的div</span><span class="p">)</span> <span class="nx">通常情况下</span><span class="err">，</span><span class="nx">监听函数位于哪个层级的节点</span><span class="err">，</span><span class="nx">只有事件经过这个节点时才会触发监听函数</span><span class="err">，</span><span class="nx">所以</span> <span class="nx">currentTarget</span> <span class="nx">通常指向</span> <span class="k">this</span> <span class="p">,</span><span class="nx">当前正在经过事件</span>
<span class="nx">e</span><span class="p">.</span><span class="nx">type</span> <span class="nx">事件类型</span><span class="p">(</span><span class="nx">look</span><span class="p">)</span>
<span class="nx">e</span><span class="p">.</span><span class="nx">timeStamp</span> <span class="nx">事假时间戳</span><span class="err">，</span><span class="nx">获取的是从网页加载到事件执行的时间间隔</span>
<span class="nx">e</span><span class="p">.</span><span class="nx">isTrusted</span> <span class="nx">事件是否由真实用户产生的</span><span class="p">(</span><span class="nx">不是脚本产生的</span><span class="p">)</span>
<span class="nx">e</span><span class="p">.</span><span class="nx">detail</span> <span class="nx">返回具体的事件信息</span><span class="err">，</span><span class="nx">例如click</span> <span class="nx">dbclick</span> <span class="nx">中</span><span class="err">，</span><span class="nx">e</span><span class="p">.</span><span class="nx">detail</span> <span class="nx">可以123</span><span class="err">，</span><span class="nx">表示点击鼠标的次数</span><span class="err">；</span><span class="nx">对于鼠标滚动事件</span><span class="err">，</span><span class="nx">返回值是鼠标滚动的距离</span><span class="p">(</span><span class="nx">这个可以出发界面缩放</span><span class="err">，</span><span class="nx">图片缩放等</span><span class="p">)</span>
</code></pre></div>
<p>实例方法</p>
<div class="highlight"><pre><span></span><code><span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span> <span class="nx">这个事件需要在</span> <span class="nx">e</span><span class="p">.</span><span class="nx">cancelable</span> <span class="o">===</span> <span class="kc">true</span> <span class="nx">下执行</span><span class="err">，</span><span class="nx">可以过滤用户输入</span><span class="p">(</span><span class="nx">只输入大写或者数字等</span><span class="p">)</span><span class="err">，</span><span class="nx">如果用户输入数字</span><span class="err">，</span><span class="nx">实际上有e的存在</span><span class="err">，</span><span class="nx">可以过滤掉</span><span class="err">。</span>
<span class="nx">e</span><span class="p">.</span><span class="nx">stopPropogation</span><span class="p">()</span>
<span class="nx">e</span><span class="p">.</span><span class="nx">stopImmediatePropogation</span><span class="p">()</span> <span class="nx">阻止当前事件和DOM节点绑定的其他事件冒泡</span>
<span class="nx">e</span><span class="p">.</span><span class="nx">composePath</span><span class="p">()</span> <span class="nx">返回一个数组</span><span class="err">，</span><span class="nx">事件冒泡的上层节点</span>
</code></pre></div>
<h3 id="94">9.4 鼠标事件<a class="headerlink" href="#94" title="Permanent link">&para;</a></h3>
<p>下面的事件是 MouseEvent 的实例</p>
<div class="highlight"><pre><span></span><code><span class="nx">click</span><span class="o">:</span> <span class="nx">用户完成</span> <span class="nx">mousedown</span> <span class="nx">mouseup</span> <span class="nx">最后触发</span> <span class="nx">click</span>
<span class="nx">dbclick</span><span class="o">:</span> <span class="nx">mousedown</span> <span class="nx">mouseup</span> <span class="nx">click</span> <span class="nx">dbclick</span>
<span class="nx">mousedown</span>
<span class="nx">mouseup</span>
<span class="nx">mousemove</span> <span class="nx">注意限流</span>
<span class="nx">mouseenter</span><span class="o">-</span><span class="nx">mouseleave</span> <span class="nx">进入子节点或者退出父节点不会触发事件</span>
<span class="nx">mouseover</span><span class="o">-</span><span class="nx">mouseout</span> <span class="nx">进入子节点或者退出父节点会触发事件</span><span class="p">,</span> <span class="nx">mouseover</span> <span class="nx">会在子节点上多次触发</span>
<span class="nx">contextmenu</span> <span class="nx">按下右键时</span><span class="p">(</span><span class="nx">右键菜单出现前</span><span class="p">)</span><span class="nx">触发</span>
<span class="nx">wheel</span> <span class="nx">滚动鼠标</span>
</code></pre></div>
<p>滚动事件和拖拽事件也是 MouseEvent 的实例，MouseEvent 事件继承了 Event 事件</p>
<p>用户可以使用构造函数自定义鼠标事件</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span> <span class="nx">e</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MouseEvent</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>

<span class="nx">下面是构造函数的可选属性</span><span class="err">：</span>
<span class="nx">screenX</span><span class="p">,</span> <span class="nx">screenY</span><span class="p">,</span> <span class="nx">clientX</span><span class="p">,</span> <span class="nx">clientY</span><span class="p">,</span>
<span class="nx">ctrlKey</span><span class="p">,</span> <span class="nx">shiftKey</span><span class="p">,</span> <span class="nx">altKey</span><span class="p">,</span> <span class="nx">metaKey</span><span class="err">（</span><span class="nx">command或者window键</span><span class="err">）</span><span class="p">,</span> 
<span class="nx">button</span><span class="p">(</span><span class="mo">012</span> <span class="nx">表示左键中键右键</span><span class="p">)</span>
<span class="nx">buttons</span><span class="p">(</span><span class="mo">000</span> <span class="mo">001</span> <span class="mo">010</span> <span class="mf">100</span> <span class="mo">011</span> <span class="nx">代表多个按键</span><span class="p">)</span>
<span class="nx">relatedTarget</span><span class="err">：</span><span class="nx">节点对象</span><span class="err">，</span><span class="nx">表示事件的相关节点</span><span class="err">，</span><span class="nx">默认为null</span><span class="err">。</span><span class="nx">mouseenter和mouseover事件时</span><span class="err">，</span><span class="nx">表示鼠标刚刚离开的那个元素节点</span><span class="err">；</span><span class="nx">mouseout和mouseleave事件时</span><span class="err">，</span><span class="nx">表示鼠标正在进入的那个元素节点</span><span class="err">。</span>
</code></pre></div>
<p>MouseEvent 实例对象的属性，除了上面的属性还具有</p>
<div class="highlight"><pre><span></span><code><span class="nx">movementX</span><span class="p">,</span> <span class="nx">movemoveY</span> <span class="nx">当前位置与上一个mousemove</span> <span class="nx">事件的位置的位移</span>
<span class="nx">offsetX</span> <span class="nx">offsetY</span> <span class="nx">鼠标位置与目标节点的相对距离</span>
<span class="nx">pageX</span><span class="p">,</span> <span class="nx">pageY</span> <span class="nx">鼠标位置与界面的相对距离</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nx">鼠标事件的实例方法</span>
<span class="nx">e</span><span class="p">.</span><span class="nx">getModifierState</span><span class="p">(</span><span class="s1">&#39;CapsLock&#39;</span><span class="p">)</span>
</code></pre></div>
<h4 id="_2">滚轮事件<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<p>WheelEvent </p>
<div class="highlight"><pre><span></span><code><span class="nx">类似于鼠标事件</span><span class="err">，</span><span class="nx">也具有构造函数和对应的属性</span>
<span class="nx">deltaX</span> <span class="nx">deltaY</span> <span class="nx">deltaZ</span> <span class="nx">表示滚轮在XYZ三个方向的位移</span>
<span class="nx">deltaMode</span> <span class="nx">是上面位移的单位</span><span class="err">，</span><span class="mo">012</span> <span class="nx">表示像素</span><span class="err">，</span><span class="nx">行</span><span class="err">，</span><span class="nx">页</span>
</code></pre></div>
<h3 id="95">9.5 键盘事件<a class="headerlink" href="#95" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nx">keydown</span> <span class="nx">keypress</span> <span class="nx">keyup</span> <span class="nx">事件</span>
<span class="nx">按下键后</span><span class="err">，</span><span class="nx">keydown</span> <span class="nx">keypress</span> <span class="p">(</span><span class="nx">keydown</span> <span class="nx">keypress</span><span class="p">)</span> <span class="nx">最后</span> <span class="nx">keyup</span> <span class="nx">功能键点击不会触发这三个事件</span>

<span class="nx">构造函数</span> <span class="kd">let</span> <span class="nx">e</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">KeyboardEvent</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
<span class="nx">key</span><span class="err">：</span><span class="nx">字符串</span><span class="err">，</span><span class="nx">当前按下的键</span><span class="err">，</span><span class="nx">默认为空字符串</span><span class="err">。</span>
<span class="nx">code</span><span class="err">：</span><span class="nx">字符串</span><span class="err">，</span><span class="nx">表示当前按下的键的字符串形式</span><span class="err">，</span><span class="nx">默认为空字符串</span><span class="err">。</span>
<span class="nx">location</span><span class="err">：</span><span class="nx">整数</span><span class="err">，</span><span class="nx">当前按下的键的位置</span><span class="err">，</span><span class="nx">默认为0</span><span class="err">。</span>
<span class="nx">ctrlKey</span><span class="err">：</span><span class="nx">布尔值</span><span class="err">，</span><span class="nx">是否按下</span> <span class="nx">Ctrl</span> <span class="nx">键</span><span class="err">，</span><span class="nx">默认为false</span><span class="err">。</span>
<span class="nx">shiftKey</span><span class="err">：</span><span class="nx">布尔值</span><span class="err">，</span><span class="nx">是否按下</span> <span class="nx">Shift</span> <span class="nx">键</span><span class="err">，</span><span class="nx">默认为false</span><span class="err">。</span>
<span class="nx">altKey</span><span class="err">：</span><span class="nx">布尔值</span><span class="err">，</span><span class="nx">是否按下</span> <span class="nx">Alt</span> <span class="nx">键</span><span class="err">，</span><span class="nx">默认为false</span><span class="err">。</span>
<span class="nx">metaKey</span><span class="err">：</span><span class="nx">布尔值</span><span class="err">，</span><span class="nx">是否按下</span> <span class="nx">Meta</span> <span class="nx">键</span><span class="err">，</span><span class="nx">默认为false</span><span class="err">。</span>
<span class="nx">repeat</span><span class="err">：</span><span class="nx">布尔值</span><span class="err">，</span><span class="nx">是否重复按键</span><span class="err">，</span><span class="nx">默认为false</span><span class="err">。</span>
</code></pre></div>
<p>构造函数的属性同样适应于实例对象的属性</p>
<div class="highlight"><pre><span></span><code><span class="nx">e</span><span class="p">.</span><span class="nx">altKey</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">ctrlKey</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">metaKey</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">shiftKey</span>
<span class="nx">e</span><span class="p">.</span><span class="nx">code</span> <span class="nx">返回当前按键的字符串形式</span><span class="p">(</span><span class="nx">KeyA</span><span class="p">)</span>
<span class="nx">e</span><span class="p">.</span><span class="nx">key</span> <span class="nx">返回按下键的名称</span><span class="p">(</span><span class="nx">如果是功能键</span><span class="err">，</span><span class="nx">返回键值</span><span class="p">)</span> <span class="nx">属性只读</span>
<span class="nx">e</span><span class="p">.</span><span class="nx">location</span> <span class="nx">返回键的位置</span><span class="p">(</span><span class="nx">主键盘0</span><span class="err">，</span><span class="nx">左右</span><span class="err">，</span><span class="nx">小键盘</span><span class="p">)</span><span class="err">，</span><span class="nx">这个属性是个鸡肋</span><span class="p">(</span><span class="nx">不能返回具体的键</span><span class="p">)</span>
<span class="nx">e</span><span class="p">.</span><span class="nx">repeat</span> <span class="nx">判断是否重复点击某个键</span>
</code></pre></div>
<p>实例对象的方法</p>
<div class="highlight"><pre><span></span><code><span class="nx">e</span><span class="p">.</span><span class="nx">getModifierState</span><span class="p">(</span><span class="s1">&#39;Alt&#39;</span><span class="p">)</span> <span class="nx">判断是否按下功能键</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">getModifierState</span><span class="p">(</span><span class="s1">&#39;Alt&#39;</span><span class="p">)</span><span class="o">+</span><span class="nx">e</span><span class="p">.</span><span class="nx">getModifierState</span><span class="p">(</span><span class="s1">&#39;Control&#39;</span><span class="p">)</span><span class="o">+</span><span class="nx">e</span><span class="p">.</span><span class="nx">getModifierState</span><span class="p">(</span><span class="s1">&#39;Meta&#39;</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">1</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// do sth</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="96">9.6进度事件<img alt="🅰" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/png/1f170.png" title=":a:" /><a class="headerlink" href="#96" title="Permanent link">&para;</a></h3>
<p>外部资源异步加载时，例如 image，link，video, audio 等资源加载时触发的事件，u或者文件上传（File upload），继承了 ProgressEvent 事件接口，主要包括下面几个事件：</p>
<div class="highlight"><pre><span></span><code>abort (退出)：用户主动点击退出事件
error 网络错误等造成的中断
loadstart 
load
loadend 加载开始，加载成功，加载结束
progress 加载中(不断触发)
timeout 加载超时
</code></pre></div>
<p>注意：如果在脚本加载前，资源已经加载，那么监听img的load事件就没有必要了。可以在事件监听前判断一下脚本是否加载。onerror 事件需要在DOM节点内部监听。</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#39;wrongURL&#39;</span> <span class="na">onerror</span><span class="o">=</span><span class="s">&quot;this.style.display=&#39;none&#39;;&quot;</span><span class="p">/&gt;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">let</span> <span class="nx">image</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;#avatar&#39;</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">image</span><span class="p">.</span><span class="nx">complete</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">image</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;load&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">image</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;finished&#39;</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span>
</code></pre></div>
<p>注意2：loadend 事件会在 abort error load 事件后执行（不管加载成功失败loadend事件都会最后执行）所以可以在这个事件后面增加处理函数。</p>
<p>注意3：error 事件不会冒泡，子元素的error事件不会触发父元素的事件监听。</p>
<p>构造函数API：这个构造函数可以描述外部资源加载的进度，例如上面的多媒体加载</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span> <span class="nx">e</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ProgressEvent</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
<span class="nx">实例属性</span>
<span class="nx">lengthComputable</span> <span class="nx">表示加载总量是否可以计算</span><span class="err">，</span><span class="nx">默认是false</span>
<span class="nx">loaded</span> <span class="nx">已加载的部分</span>
<span class="nx">total</span> <span class="nx">总量</span>
<span class="nx">使用</span> <span class="nx">e</span><span class="p">.</span><span class="nx">loaded</span> <span class="o">/</span> <span class="nx">e</span><span class="p">.</span><span class="nx">total</span> <span class="nx">可以计算加载的百分比</span>
</code></pre></div>
<p>类似于其他事件，构造函数的options和实例属性相同（JS例子）。</p>
<h3 id="97">9.7 表单事件<a class="headerlink" href="#97" title="Permanent link">&para;</a></h3>
<h4 id="input">input<a class="headerlink" href="#input" title="Permanent link">&para;</a></h4>
<p>input select textarea 元素会触发 input 事件，继承自 Inputvent 构造函数。这个事件在用户触发时会频繁触发。input 事件相对于 change 事件，change 事件在输入框失去焦点后触发，但是input事件会始终触发。</p>
<h4 id="select">select<a class="headerlink" href="#select" title="Permanent link">&para;</a></h4>
<p>选中文本事件：在 input textarea 中，如果选中文本，会触发这个事件，可以通过实例对象的属性获取文本信息</p>
<div class="highlight"><pre><span></span><code>&lt;input id=&quot;test&quot; type=&quot;text&quot;&gt;&lt;/input&gt;

let ele = document.getElementById(&#39;#test&#39;);
ele.addEventListener(&#39;select&#39;, (e) =&gt; {
  console.log(e.type === &#39;select&#39;);
}, false);
e.target.value (selectionirection selectionStart selectionEnd) 可以获取选中的文本
</code></pre></div>
<h4 id="change">change<a class="headerlink" href="#change" title="Permanent link">&para;</a></h4>
<p>change 事件会在输入元素变化时触发，不会连续触发，input 事件必然伴随着 select 事件</p>
<ul>
<li>激活单选框或者复选框 radio checkbox 会触发</li>
<li>用户提交：例如 select 或者日期组件（对于select元素，input事件和change事件基本相等）</li>
<li>当文本框 input type=text 或者 textarea 的值发生改变，并且失去焦点后触发</li>
</ul>
<h4 id="invalid">invalid<a class="headerlink" href="#invalid" title="Permanent link">&para;</a></h4>
<p>当表单是必填项，如果不填，点击提交时会触发这个事件(或者不满足输入框的条件)</p>
<div class="highlight"><pre><span></span><code>&lt;form&gt;
  &lt;input type=&quot;text&quot; required oninvalid=&quot;console.log(&#39;invalid input&#39;)&quot; /&gt;
  &lt;button type=&quot;submit&quot;&gt;提交&lt;/button&gt;
&lt;/form&gt;
</code></pre></div>
<h4 id="reset-submit">reset submit<a class="headerlink" href="#reset-submit" title="Permanent link">&para;</a></h4>
<p>这两个事件发生在表单对象  form 上面，并不是在表单成员 button 上面（提交的是表单不是按钮）。</p>
<h4 id="_3">构造函数<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<p>InputEvent 实例属性是只读的</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span> <span class="nx">e</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">InputEvent</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
<span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">data</span> <span class="nx">字符串</span><span class="err">，</span><span class="nx">表示变动后的内容</span>
  <span class="nx">inputType</span> <span class="nx">字符串</span><span class="err">，</span><span class="nx">表示变更的类型</span><span class="p">(</span><span class="nx">insertText</span><span class="err">，</span><span class="nx">insertFromPaste</span><span class="err">，</span><span class="nx">输入文本或者粘贴文本</span><span class="p">)</span>
  <span class="nx">dataTransfer</span> <span class="nx">返回</span> <span class="nx">DataTransfer</span> <span class="nx">实例</span><span class="err">。</span><span class="nx">该属性只在文本框接受粘贴内容</span><span class="err">（</span><span class="nx">insertFromPaste</span><span class="err">）</span><span class="nx">或拖拽内容</span><span class="err">（</span><span class="nx">insertFromDrop</span><span class="err">）</span><span class="nx">时才有效</span>
<span class="p">};</span>
</code></pre></div>
<h3 id="98">9.8 触摸事件<a class="headerlink" href="#98" title="Permanent link">&para;</a></h3>
<p>触摸事件 API Touch TouchList TouchEvent。多个Touch同时发生构成TouchList。触摸屏设备会触发这部分事件。通常情况，touch事件和鼠标事件同时发生（避免某些代码没有用到触摸事件），单纯使用Touch事件需要把鼠标事件 e.preventDefault() 处理。</p>
<h4 id="touch">Touch<a class="headerlink" href="#touch" title="Permanent link">&para;</a></h4>
<p>Touch 构造函数可以创建Touch实例。与click事件不同的地方：Touch事件是一个椭圆形区域，压力参数（手指触摸或者笔尖触摸）。实例属性和构造函数参数相同。</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span> <span class="nx">touch</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Touch</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">identifer</span><span class="o">:</span> <span class="mf">10</span><span class="p">,</span> <span class="c1">// 唯一标识，触摸过程中不变</span>
  <span class="nx">target</span><span class="o">:</span> <span class="nx">div</span><span class="p">,</span>
  <span class="nx">clientX</span><span class="o">:</span> 
  <span class="nx">clientY</span><span class="o">:</span>
  <span class="nx">screenX</span><span class="o">:</span>
  <span class="nx">screenY</span><span class="o">:</span>
  <span class="nx">pageX</span><span class="o">:</span>
  <span class="nx">pageY</span><span class="o">:</span>
  <span class="nx">radiusX</span><span class="o">:</span> <span class="nx">触摸区域影响X轴的长度</span><span class="p">(</span><span class="nx">px</span><span class="p">)</span> <span class="nx">乘以2就是实际的长度或者宽度</span>
  <span class="nx">radiusY</span><span class="o">:</span> <span class="nx">Y轴的长度</span>
  <span class="nx">rotationAngle</span><span class="o">:</span> <span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">90</span><span class="p">]</span> <span class="nx">旋转角度</span><span class="p">(</span><span class="nx">触摸区域椭圆旋转角度</span><span class="p">)</span>
  <span class="nx">force</span><span class="o">:</span> <span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="nx">压力</span><span class="p">(</span><span class="mf">0</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="touchlist">TouchList<a class="headerlink" href="#touchlist" title="Permanent link">&para;</a></h4>
<p>触摸事件的集合，API</p>
<div class="highlight"><pre><span></span><code><span class="nx">TouchList</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mf">2</span>
<span class="nx">TouchList</span><span class="p">.</span><span class="nx">item</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span>
</code></pre></div>
<h4 id="touchevent">TouchEvent<a class="headerlink" href="#touchevent" title="Permanent link">&para;</a></h4>
<p>构造函数继承自 Event 事件</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span> <span class="nx">e</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TouchEvent</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
<span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">crtlKey</span><span class="o">:</span>
  <span class="nx">altKey</span><span class="o">:</span>
  <span class="nx">metaKey</span><span class="o">:</span>
  <span class="nx">shiftKey</span><span class="o">:</span>
  <span class="nx">touches</span><span class="o">:</span> <span class="p">[]</span> <span class="nx">当前处于活动状态的触摸点</span>
  <span class="nx">targetTouches</span><span class="o">:</span> <span class="p">[]</span> <span class="nx">位于触摸目标DOM内部且处于活动状态的触摸点</span>
  <span class="nx">changedTouche</span><span class="o">:</span> <span class="p">[]</span> <span class="nx">本次触摸过程的相关触摸点</span>
<span class="p">};</span>
</code></pre></div>
<p>实例属性是只读属性，类似于上面的参数</p>
<h4 id="touchevent_1">TouchEvent 分类<a class="headerlink" href="#touchevent_1" title="Permanent link">&para;</a></h4>
<p>touchstart</p>
<p>touchend 触摸结束或者触摸到屏幕边缘</p>
<p>touchmove</p>
<p>touchcancel 触摸时弹出菜单或者对话框，或者用户的触摸点很多，触摸事件取消</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span> <span class="nx">el</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;canvas&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">];</span>
<span class="nx">el</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;touchstart&#39;</span><span class="p">,</span> <span class="nx">onStart</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="nx">el</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;touchmove&#39;</span><span class="p">,</span> <span class="nx">onMove</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">onStart</span> <span class="o">=</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
  <span class="kd">let</span> <span class="nx">touches</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">changedTouches</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mf">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">touches</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">touches</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">pageX</span><span class="p">,</span> <span class="nx">touches</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">pageY</span><span class="p">);</span>
    <span class="c1">// 获取开始触摸点(多个)的页面坐标</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">onMove</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">touches</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">changedTouches</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mf">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">touches</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">touches</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">pageX</span><span class="p">,</span> <span class="nx">touches</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">pageY</span><span class="p">);</span>
    <span class="c1">// 触摸点移动时坐标的变化</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="99">9.9 拖拽事件<img alt="🅰" class="emojione" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/png/1f170.png" title=":a:" /><a class="headerlink" href="#99" title="Permanent link">&para;</a></h3>
<p>DragEvent 具有 <mark>dataTransfer</mark> 的属性，这个属性很重要！dataTransfer 具有很多属性和方法</p>
<h4 id="1">1.拖拽对象<a class="headerlink" href="#1" title="Permanent link">&para;</a></h4>
<p><strong>拖拽对象</strong>：被拖拽的对象（例如文件或者图片链接），拖拽对象经过的对象（div，拖拽对象可以放入div中）</p>
<p><strong>可拖拽属性</strong>：网页中的图片、链接、选中的文本默认可以拖动，其他元素默认不可拖动。如果在 div 内部设置 draggable = 'true' 后，这个DIV就是可以拖动的。对于 img 和 a ，这个属性默认是 true。实际中，可以设置图片或者链接是不可以拖动的。如果某元素是可以拖动的，就无法用鼠标选中内部的文本。</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">div</span> <span class="na">draggable</span><span class="o">=</span><span class="s">&quot;true&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">img</span> <span class="na">draggable</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="p">/&gt;</span>
</code></pre></div>
<h4 id="2">2.拖拽事件<a class="headerlink" href="#2" title="Permanent link">&para;</a></h4>
<p><strong>被拖拽对象的事件</strong></p>
<div class="highlight"><pre><span></span><code><span class="nx">dragstart</span><span class="o">:</span> <span class="nx">开始拖拽</span><span class="err">，</span><span class="nx">在这个事件的监听函数上</span><span class="err">，</span><span class="nx">指定拖拉的数据</span><span class="p">(</span><span class="nx">image</span><span class="p">)</span>
<span class="nx">drag</span><span class="o">:</span> <span class="nx">拖拽中</span><span class="err">，</span><span class="nx">几百ms触发一次</span>
<span class="nx">dragend</span><span class="err">：</span><span class="nx">拖拽结束</span><span class="p">(</span><span class="nx">释放鼠标或者ESC</span><span class="p">)</span> <span class="nx">与</span> <span class="nx">dragstart</span> <span class="nx">成对出现</span>
</code></pre></div>
<p><strong>推拽对象经过元素的事件</strong> </p>
<div class="highlight"><pre><span></span><code><span class="nx">dragenter</span><span class="err">：</span><span class="nx">被拖拽元素进入div后</span><span class="err">，</span><span class="nx">div触发一次事件</span><span class="err">；</span><span class="nx">在事件监听函数中处理div是否允许</span> <span class="nx">drop</span> <span class="nx">事件放下拖拽的数据</span><span class="p">(</span><span class="nx">默认div不允许drop事件</span><span class="p">)</span><span class="err">；</span>
<span class="nx">dragover</span><span class="err">：</span><span class="nx">DIV</span> <span class="nx">元素持续触发这个事件</span><span class="p">(</span><span class="nx">只要没有离开这个DIV</span><span class="p">)</span>
<span class="nx">dragleave</span><span class="err">：</span><span class="nx">img</span> <span class="nx">离开DIV范围后触发</span>
<span class="nx">drop</span><span class="err">：</span><span class="nx">在目标节点DIV上释放鼠标触发</span><span class="err">，</span><span class="nx">监听函数可以取出数据并处理</span><span class="p">(</span><span class="nx">目标节点DIV需要预设允许drop</span><span class="p">)</span>
</code></pre></div>
<p><strong>注意</strong></p>
<ul>
<li>
<p>拖拽事件中，鼠标移动但是不会触发鼠标事件</p>
</li>
<li>
<p>把文件从桌面拖进浏览器，不会触发 dragstart dragend 事件</p>
</li>
<li>
<p>dragenter dragover 的监听函数用于处理拖拽数据，但是大部分DIV默认设置不能drop事件，所以必须阻止默认事件</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">div</span> <span class="na">ondragover</span><span class="o">=</span><span class="s">&quot;event.preventDefault()&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="3">3.拖拽实例<a class="headerlink" href="#3" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code> <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropzone&quot;</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;draggable&quot;</span> <span class="na">draggable</span><span class="o">=</span><span class="s">&quot;true&quot;</span><span class="p">&gt;</span>
     该节点可拖拉
   <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
 <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropzone&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>
<p>拖拽事件</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span> <span class="nx">dragged</span><span class="p">;</span>

<span class="c1">// for dragged image</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;dragstart&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">dragged</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">;</span>
  <span class="nx">dragged</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="p">},</span> <span class="kc">false</span><span class="p">);</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;dragend&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">opacity</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="p">},</span> <span class="kc">false</span><span class="p">);</span>

<span class="nb">document</span><span class="p">.</span><span class="nx">addEventListenrt</span><span class="p">(</span><span class="s1">&#39;dragover&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
  <span class="c1">// 防止拖拉效果被重置，允许被拖拉的节点放入目标节点</span>
<span class="p">},</span> <span class="kc">false</span><span class="p">);</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">addEventListerer</span><span class="p">(</span><span class="s1">&#39;dragenter&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">className</span> <span class="o">===</span> <span class="s1">&#39;dropzone&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// 由于该事件会冒泡，所以要过滤节点</span>
    <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">},</span> <span class="kc">false</span><span class="p">);</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">addEventListerer</span><span class="p">(</span><span class="s1">&#39;dragleave&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="p">},</span> <span class="kc">false</span><span class="p">);</span>

<span class="nb">document</span><span class="p">.</span><span class="nx">addEventListerer</span><span class="p">(</span><span class="s1">&#39;drop&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span> <span class="c1">// 防止事件默认行为（比如某些元素节点上可以打开链接）</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">className</span> <span class="o">===</span> <span class="s1">&#39;dropzone&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="nx">dragged</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">dragged</span><span class="p">);</span>
    <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">appendChilde</span><span class="p">(</span><span class="nx">dragged</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">},</span> <span class="kc">false</span><span class="p">);</span>
</code></pre></div>
<p>拖拽事件继承于构造函数  dragEvent</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span> <span class="nx">e</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">dragEvent</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
<span class="nx">type</span> <span class="nx">是拖拽事件的类型</span>
<span class="nx">options</span> <span class="nx">是null或者是</span> <span class="nx">dataTranster</span> <span class="nx">的实例对象</span>
</code></pre></div>
<h4 id="4-datatransfer">4、数据传输器 dataTransfer<a class="headerlink" href="#4-datatransfer" title="Permanent link">&para;</a></h4>
<p>dragEvent 具有一个 dataTransfer 属性，用来读写需要传递的属性。这个属性继承 dataTranster 构造函数</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span> <span class="nx">dataTransfer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">dataTransfer</span><span class="p">();</span> <span class="c1">// 构造函数无参数</span>
</code></pre></div>
<p>数据传递器包含：数据的类型（文件格式，text/plain image/png）和数据的值。</p>
<p>拖拽事件中，dragenter dragover 事件的监听函数可以判断当前的数据类型，确定当前的 div 能否接受这个数据类型（是否支持drop事件）。发生 drop 事件时，监听函数从dataTransfer 中取出数据的值。</p>
<h4 id="5">5、数据传输器的属性<a class="headerlink" href="#5" title="Permanent link">&para;</a></h4>
<p>5.1 dataTransfer.dropEffect</p>
<div class="highlight"><pre><span></span><code><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">dropEffect</span> <span class="o">=</span> <span class="s1">&#39;copy&#39;</span> <span class="s1">&#39;move&#39;</span> <span class="s1">&#39;link&#39;</span> <span class="s1">&#39;none&#39;</span><span class="p">;</span>
<span class="nx">设置放下被拖拽节点的效果</span><span class="p">(</span><span class="nx">鼠标形状改变</span><span class="p">)</span><span class="nx">其他值是无效的</span><span class="err">。</span><span class="nx">这个属性在</span> <span class="nx">dragenter</span> <span class="nx">dragover</span> <span class="nx">事件中监听</span><span class="err">，</span><span class="nx">这个属性对于被拖拽节点是无效的</span><span class="err">，</span><span class="nx">只对DIV有效果</span><span class="err">（</span><span class="nx">鼠标变化</span><span class="err">）。</span>
</code></pre></div>
<p>5.2 dataTransfer.effectAllowed</p>
<div class="highlight"><pre><span></span><code><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">effectAllowed</span> <span class="o">=</span> <span class="s1">&#39;copy&#39;</span> <span class="s1">&#39;move&#39;</span> <span class="s1">&#39;link&#39;</span> <span class="s1">&#39;all&#39;</span> <span class="p">...</span>
<span class="nx">设置本次拖拉中允许的效果</span><span class="o">:</span><span class="nx">这个属性与dropEffect属性是同一件事的两个方面</span><span class="err">。</span><span class="nx">前者设置被拖拉的节点允许的效果</span><span class="err">，</span><span class="nx">后者设置接受拖拉的区域的效果</span><span class="err">，</span><span class="nx">它们往往配合使用</span><span class="err">。</span> <span class="nx">这个属性在</span> <span class="nx">dragstart</span> <span class="nx">事件处理函数中设置</span><span class="err">。</span>
</code></pre></div>
<p>5.3 dataTransfer.files</p>
<p>dataTransfer.files 是一个 fileList 对象，可以用来拖拽文件。可以使用 FileReader 读取文件的内容</p>
<p>fileList and FileReader example</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;output&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;min-height: 200px;border: 1px solid black;&quot;</span><span class="p">&gt;</span>文件拖拉到这里<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">var</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">);</span>

<span class="nx">div</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;dragenter&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">div</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
  <span class="nx">event</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
  <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
<span class="p">},</span> <span class="kc">false</span><span class="p">);</span>

<span class="nx">div</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;dragover&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">event</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
  <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
<span class="p">},</span> <span class="kc">false</span><span class="p">);</span>

<span class="nx">div</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;drop&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
  <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
  <span class="kd">let</span> <span class="nx">files</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">files</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mf">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">files</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// get files names and info(size)</span>
    <span class="nx">div</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">+=</span> <span class="nx">files</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">name</span> <span class="o">+</span> <span class="nx">files</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">size</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">files</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mf">0</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
  <span class="kd">let</span> <span class="nx">file</span> <span class="o">=</span> <span class="nx">files</span><span class="p">[</span><span class="mf">0</span><span class="p">];</span>
  <span class="kd">let</span> <span class="nx">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FileReader</span><span class="p">();</span>
  <span class="c1">// set reader loadend fucntion</span>
  <span class="nx">reader</span><span class="p">.</span><span class="nx">onloadend</span> <span class="o">=</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="nx">FileReader</span><span class="p">.</span><span class="nx">DONE</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">let</span> <span class="nx">content</span> <span class="o">=</span> <span class="nx">reader</span><span class="p">.</span><span class="nx">result</span><span class="p">;</span>
      <span class="nx">div</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">file</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="nx">content</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="c1">// start to read file</span>
  <span class="nx">reader</span><span class="p">.</span><span class="nx">readAsBinaryString</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
<span class="p">},</span> <span class="kc">false</span><span class="p">);</span>
</code></pre></div>
<p>5.4 dataTransfer.types</p>
<p>这个属性是只读的数组，每一项是拖拉数据的文件类型。可以在 dragover 事件处理函数中判断文件类型，确定是否可以 drop 文件</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span> <span class="nx">containsFile</span><span class="p">(</span><span class="nx">filelist</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">filelist</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mf">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mf">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">filelist</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">isLink</span> <span class="o">=</span> <span class="nx">containsFile</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">types</span><span class="p">,</span> <span class="s1">&#39;text/uri-list&#39;</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">isLink</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<p>5.5 dataTransfer.items</p>
<p>属性返回一个伪数组（伪数组是 DataTransferItemList 的实例），其中每一项是本次拖拽的一个对象（对象是DataTransferItem 的实例）。如果拖拽不包含对象，那么返回一个空对象。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// DataTransferItemList 实例的API</span>
<span class="nx">length</span><span class="err">：</span><span class="nx">返回成员的数量</span>
<span class="nx">add</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">type</span><span class="p">)</span><span class="err">：</span><span class="nx">增加一个指定内容和类型</span><span class="err">（</span><span class="nx">比如text</span><span class="o">/</span><span class="nx">html和text</span><span class="o">/</span><span class="nx">plain</span><span class="err">）</span><span class="nx">的字符串作为成员</span>
<span class="nx">add</span><span class="p">(</span><span class="nx">file</span><span class="p">)</span><span class="err">：</span><span class="nx">add方法的另一种用法</span><span class="err">，</span><span class="nx">增加一个文件作为成员</span>
<span class="nx">remove</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span><span class="err">：</span><span class="nx">移除指定位置的成员</span>
<span class="nx">clear</span><span class="p">()</span><span class="err">：</span><span class="nx">移除所有的成员</span>

<span class="c1">// DataTransferItem 实例的API</span>
<span class="nx">kind</span><span class="err">：</span><span class="nx">返回成员的种类</span><span class="err">（</span><span class="nx">string还是file</span><span class="err">）。</span>
<span class="nx">type</span><span class="err">：</span><span class="nx">返回成员的类型</span><span class="err">（</span><span class="nx">通常是</span> <span class="nx">MIME</span> <span class="nx">值</span><span class="err">）。</span>
<span class="nx">getAsFile</span><span class="p">()</span><span class="err">：</span><span class="nx">如果被拖拉是文件</span><span class="err">，</span><span class="nx">返回该文件</span><span class="err">，</span><span class="nx">否则返回null</span><span class="err">。</span>
<span class="nx">getAsString</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span><span class="err">：</span><span class="nx">如果被拖拉的是字符串</span><span class="err">，</span><span class="nx">将该字符传入指定的回调函数处理</span><span class="err">。</span><span class="nx">该方法是异步的</span><span class="err">，</span><span class="nx">所以需要传入回调函数</span><span class="err">。</span>
</code></pre></div>
<p>example</p>
<div class="highlight"><pre><span></span><code><span class="nx">div</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;drop&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">items</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mf">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">e</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">items</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">items</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">kind</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="nx">e</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">items</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">type</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<h4 id="6">6、数据传输器的方法<a class="headerlink" href="#6" title="Permanent link">&para;</a></h4>
<h5 id="1setdata">1、setdata 用来设置拖拉事件所带有的数据<a class="headerlink" href="#1setdata" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="nx">e</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s1">&#39;text/plain&#39;</span><span class="p">,</span> <span class="s1">&#39;this is Andy&#39;</span><span class="p">);</span>
</code></pre></div>
<p>该方法接受两个参数，都是字符串。第一个参数表示数据类型（比如<code>text/plain</code>），第二个参数是具体数据。如果指定类型的数据在<code>dataTransfer</code>属性不存在，那么这些数据将被加入，否则原有的数据将被新数据替换。</p>
<p>如果是拖拉文本框或者拖拉选中的文本，会默认将对应的文本数据，添加到<code>dataTransfer</code>属性，不用手动指定。</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">div</span> <span class="na">draggable</span><span class="o">=</span><span class="s">&quot;true&quot;</span><span class="p">&gt;</span>
  aaa
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>
<p>上面代码中，拖拉这个<code>&lt;div&gt;</code>元素会自动带上文本数据<code>aaa</code>。</p>
<p>使用<code>setData</code>方法，可以替换到原有数据。</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">div</span>
  <span class="na">draggable</span><span class="o">=</span><span class="s">&quot;true&quot;</span>
  <span class="na">ondragstart</span><span class="o">=</span><span class="s">&quot;event.dataTransfer.setData(&#39;text/plain&#39;, &#39;bbb&#39;)&quot;</span>
<span class="p">&gt;</span>
  aaa
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>
<p>上面代码中，拖拉数据实际上是<code>bbb</code>，而不是<code>aaa</code>。</p>
<p>下面是添加其他类型的数据。由于<code>text/plain</code>是最普遍支持的格式，为了保证兼容性，建议最后总是保存一份纯文本格式的数据。</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span> <span class="nx">dt</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">;</span>

<span class="c1">// 添加链接</span>
<span class="nx">dt</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s1">&#39;text/uri-list&#39;</span><span class="p">,</span> <span class="s1">&#39;http://www.example.com&#39;</span><span class="p">);</span>
<span class="nx">dt</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s1">&#39;text/plain&#39;</span><span class="p">,</span> <span class="s1">&#39;http://www.example.com&#39;</span><span class="p">);</span>

<span class="c1">// 添加 HTML 代码</span>
<span class="nx">dt</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s1">&#39;text/html&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello there, &lt;strong&gt;stranger&lt;/strong&gt;&#39;</span><span class="p">);</span>
<span class="nx">dt</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s1">&#39;text/plain&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello there, &lt;strong&gt;stranger&lt;/strong&gt;&#39;</span><span class="p">);</span>

<span class="c1">// 添加图像的 URL</span>
<span class="nx">dt</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s1">&#39;text/uri-list&#39;</span><span class="p">,</span> <span class="nx">imageurl</span><span class="p">);</span>
<span class="nx">dt</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s1">&#39;text/plain&#39;</span><span class="p">,</span> <span class="nx">imageurl</span><span class="p">);</span>
</code></pre></div>
<p>可以一次提供多种格式的数据。</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span> <span class="nx">dt</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">;</span>
<span class="nx">dt</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s1">&#39;application/x-bookmark&#39;</span><span class="p">,</span> <span class="nx">bookmarkString</span><span class="p">);</span>
<span class="nx">dt</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s1">&#39;text/uri-list&#39;</span><span class="p">,</span> <span class="s1">&#39;http://www.example.com&#39;</span><span class="p">);</span>
<span class="nx">dt</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s1">&#39;text/plain&#39;</span><span class="p">,</span> <span class="s1">&#39;http://www.example.com&#39;</span><span class="p">);</span>
</code></pre></div>
<p>上面代码中，通过在同一个事件上面，存放三种类型的数据，使得拖拉事件可以在不同的对象上面，<code>drop</code>不同的值。注意，第一种格式是一个自定义格式，浏览器默认无法读取，这意味着，只有某个部署了特定代码的节点，才可能<code>drop</code>（读取到）这个数据。</p>
<h5 id="2datatransfergetdata">2、DataTransfer.getData()<a class="headerlink" href="#2datatransfergetdata" title="Permanent link">&para;</a></h5>
<p><code>DataTransfer.getData()</code>方法接受一个字符串（表示数据类型）作为参数，返回事件所带的指定类型的数据（通常是用<code>setData</code>方法添加的数据）。如果指定类型的数据不存在，则返回空字符串。通常只有<code>drop</code>事件触发后，才能取出数据。</p>
<p>下面是一个<code>drop</code>事件的监听函数，用来取出指定类型的数据。</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span> <span class="nx">onDrop</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">getData</span><span class="p">(</span><span class="s1">&#39;text/plain&#39;</span><span class="p">);</span>
  <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
  <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<p>上面代码取出拖拉事件的文本数据，将其替换成当前节点的文本内容。注意，这时还必须取消浏览器的默认行为，因为假如用户拖拉的是一个链接，浏览器默认会在当前窗口打开这个链接。</p>
<p><code>getData</code>方法返回的是一个字符串，如果其中包含多项数据，就必须手动解析。</p>
<div class="highlight"><pre><span></span><code>function doDrop(event) {
  var lines = event.dataTransfer.getData(&#39;text/uri-list&#39;).split(&#39;\n&#39;);
  for (let line of lines) {
    let link = document.createElement(&#39;a&#39;);
    link.href = line;
    link.textContent = line;
    event.target.appendChild(link);
  }
  event.preventDefault();
}
</code></pre></div>
<p>上面代码中，<code>getData</code>方法返回的是一组链接，就必须自行解析。</p>
<p>类型值指定为<code>URL</code>，可以取出第一个有效链接。</p>
<div class="highlight"><pre><span></span><code>var link = event.dataTransfer.getData(&#39;URL&#39;);
</code></pre></div>
<p>下面的例子是从多种类型的数据里面取出数据。</p>
<div class="highlight"><pre><span></span><code>function doDrop(event) {
  var types = event.dataTransfer.types;
  var supportedTypes = [&#39;text/uri-list&#39;, &#39;text/plain&#39;];
  types = supportedTypes.filter(function (value) { types.includes(value) });
  if (types.length) {
    var data = event.dataTransfer.getData(types[0]);
  }
  event.preventDefault();
}
</code></pre></div>
<h5 id="3datatransfercleardata">3、DataTransfer.clearData()<a class="headerlink" href="#3datatransfercleardata" title="Permanent link">&para;</a></h5>
<p><code>DataTransfer.clearData()</code>方法接受一个字符串（表示数据类型）作为参数，删除事件所带的指定类型的数据。如果没有指定类型，则删除所有数据。如果指定类型不存在，则调用该方法不会产生任何效果。</p>
<div class="highlight"><pre><span></span><code>event.dataTransfer.clearData(&#39;text/uri-list&#39;);
</code></pre></div>
<p>上面代码清除事件所带的<code>text/uri-list</code>类型的数据。</p>
<p>该方法不会移除拖拉的文件，因此调用该方法后，<code>DataTransfer.types</code>属性可能依然会返回<code>Files</code>类型（前提是存在文件拖拉）。</p>
<p>注意，该方法只能在<code>dragstart</code>事件的监听函数之中使用，因为这是拖拉操作的数据唯一可写的时机。</p>
<h5 id="4datatransfersetdragimage">4、DataTransfer.setDragImage()<a class="headerlink" href="#4datatransfersetdragimage" title="Permanent link">&para;</a></h5>
<p>拖动过程中（<code>dragstart</code>事件触发后），浏览器会显示一张图片跟随鼠标一起移动，表示被拖动的节点。这张图片是自动创造的，通常显示为被拖动节点的外观，不需要自己动手设置。</p>
<p><code>DataTransfer.setDragImage()</code>方法可以自定义这张图片。它接受三个参数。第一个是<code>&lt;img&gt;</code>节点或者<code>&lt;canvas&gt;</code>节点，如果省略或为<code>null</code>，则使用被拖动的节点的外观；第二个和第三个参数为鼠标相对于该图片左上角的横坐标和右坐标。</p>
<p>下面是一个例子。</p>
<div class="highlight"><pre><span></span><code>/* HTML 代码如下
 &lt;div id=&quot;drag-with-image&quot; class=&quot;dragdemo&quot; draggable=&quot;true&quot;&gt;
   drag me
 &lt;/div&gt;
*/

var div = document.getElementById(&#39;drag-with-image&#39;);
div.addEventListener(&#39;dragstart&#39;, function (e) {
  var img = document.createElement(&#39;img&#39;);
  img.src = &#39;http://path/to/img&#39;;
  e.dataTransfer.setDragImage(img, 0, 0);
}, false);
</code></pre></div>
<h3 id="910">9.10 其他事件<a class="headerlink" href="#910" title="Permanent link">&para;</a></h3>
<h4 id="1beforeunload">1、beforeUnload<a class="headerlink" href="#1beforeunload" title="Permanent link">&para;</a></h4>
<p>窗口、文档、各种资源卸载前触发事件，主要避免用户未提交保存表单，误操作关闭网页。</p>
<div class="highlight"><pre><span></span><code><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;beforeunload&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">confirmationMessage</span> <span class="o">=</span> <span class="s1">&#39;确认关闭窗口？&#39;</span><span class="p">;</span>
  <span class="nx">e</span><span class="p">.</span><span class="nx">returnValue</span> <span class="o">=</span> <span class="nx">confirmationMessage</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">confirmationMessage</span><span class="p">;</span>
<span class="p">});</span>
<span class="c1">// 使用 e.returnValue 和 return 可以保证兼容性。对于IE浏览器可以显示提示文本，谷歌浏览器会显示默认文本</span>
</code></pre></div>
<h4 id="2unload">2、unload<a class="headerlink" href="#2unload" title="Permanent link">&para;</a></h4>
<p>在窗口关闭或者DOM被卸载前执行这个事件，发生在 beforeUnload 之后。这个事件如果抛出异常，界面DOM依然会卸载，文档不可见，UI交互失效，所以基本不用。</p>
<div class="highlight"><pre><span></span><code><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;unload&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;never use this event&#39;</span><span class="p">)</span>
<span class="p">});</span>
</code></pre></div>
<h4 id="3load-error-abort">3、load error abort<a class="headerlink" href="#3load-error-abort" title="Permanent link">&para;</a></h4>
<p>资源加载完毕，资源出错，用户取消资源加载触发事件， window，DOM， AJax 请求都会触发这个事件。注意：网页从本地缓存中加载不会触发这个事件。</p>
<div class="highlight"><pre><span></span><code><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;load&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="p">...</span>
<span class="p">});</span>
</code></pre></div>
<h4 id="4pageshow-pagehide">4、pageshow pagehide<a class="headerlink" href="#4pageshow-pagehide" title="Permanent link">&para;</a></h4>
<p>网页加载的两种方式：从服务器端获取资源加载，或者从缓存中加载（点击前进或者后退按钮）。</p>
<p>load 事件会在首次加载触发，如果从缓存中加载就不会触发。</p>
<p>pageshow事件，在首次加载或者缓存加载都会触发（首次加载中，load先触发，pageshow后触发）。通过 pageshow 的 e.persisted 可以判断是否首次加载：如果是true就是从缓存中加载，false表示首次加载。</p>
<p>pagehide 事件会在界面关闭前触发，如果 e.persisted 是 true, 页面会保存在缓存中；false 表示不保存在缓存中。</p>
<p>Pageshow pagehide 在 history 对象变化时触发，和网页是否可见无关。</p>
<h4 id="5popstate">5、popstate<a class="headerlink" href="#5popstate" title="Permanent link">&para;</a></h4>
<p>这个事件在 history 对象显示切换时触发（鼠标点击前进后退，history.back(), history.forward(), history.go() 触发）。隐式切换不会触发(history.pushState(), history.replaceState())。</p>
<p>FF界面首次加载不会触发 popstate 事件，其他会触发。</p>
<div class="highlight"><pre><span></span><code><span class="nb">window</span><span class="p">.</span><span class="nx">onpopstate</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;state: &#39;</span> <span class="o">+</span> <span class="nx">event</span><span class="p">.</span><span class="nx">state</span><span class="p">);</span>
  <span class="c1">// 获取当前事件的状态</span>
<span class="p">};</span>
<span class="nx">history</span><span class="p">.</span><span class="nx">pushState</span><span class="p">({</span><span class="nx">page</span><span class="o">:</span> <span class="mf">1</span><span class="p">},</span> <span class="s1">&#39;title 1&#39;</span><span class="p">,</span> <span class="s1">&#39;?page=1&#39;</span><span class="p">);</span> <span class="c1">// 隐式增加一条记录，不会触发事件</span>
<span class="nx">history</span><span class="p">.</span><span class="nx">pushState</span><span class="p">({</span><span class="nx">page</span><span class="o">:</span> <span class="mf">2</span><span class="p">},</span> <span class="s1">&#39;title 2&#39;</span><span class="p">,</span> <span class="s1">&#39;?page=2&#39;</span><span class="p">);</span> <span class="c1">// 隐式增加一条记录</span>
<span class="nx">history</span><span class="p">.</span><span class="nx">replaceState</span><span class="p">({</span><span class="nx">page</span><span class="o">:</span> <span class="mf">3</span><span class="p">},</span> <span class="s1">&#39;title 3&#39;</span><span class="p">,</span> <span class="s1">&#39;?page=3&#39;</span><span class="p">);</span> <span class="c1">// 改变当前的记录，不会触发</span>
<span class="nx">history</span><span class="p">.</span><span class="nx">back</span><span class="p">();</span> <span class="c1">// state: {&quot;page&quot;:1} 页面后退一次</span>
<span class="nx">history</span><span class="p">.</span><span class="nx">back</span><span class="p">();</span> <span class="c1">// state: null  页面再后退一次</span>
<span class="nx">history</span><span class="p">.</span><span class="nx">go</span><span class="p">(</span><span class="mf">2</span><span class="p">);</span>  <span class="c1">// state: {&quot;page&quot;:3} 页面向前两次</span>
</code></pre></div>
<h4 id="6hashchange">6、hashchange<a class="headerlink" href="#6hashchange" title="Permanent link">&para;</a></h4>
<p>hash 变化是触发这个事件，通过属性可以获取前后的完整 URL。</p>
<div class="highlight"><pre><span></span><code><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;hashchange&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">oldURL</span><span class="p">)</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">newURL</span><span class="p">)</span>
<span class="p">});</span>
</code></pre></div>
<h4 id="7domcontentloaded">7、DOMContentLoaded<a class="headerlink" href="#7domcontentloaded" title="Permanent link">&para;</a></h4>
<p>这个事件是 DOM 加载完成，但是其他资源（image）还没有加载触发的事件，比load 事件更早。</p>
<h4 id="8readystatechange">8、readystatechange<a class="headerlink" href="#8readystatechange" title="Permanent link">&para;</a></h4>
<p>网页加载状态变化触发事件（loading -&gt; interactive -&gt; complete -&gt; load）</p>
<h4 id="9scroll">9、scroll<a class="headerlink" href="#9scroll" title="Permanent link">&para;</a></h4>
<p>界面滚动触发，使用很多。</p>
<p>这个事件在界面滚动时会持续触发，需要考虑性能问题。</p>
<p>方法1：可以使用requestAnimationFrame优化。界面每次重绘(每秒60次)，只会触发一次scroll事件</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">throttle</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nx">obj</span> <span class="o">||</span> <span class="nb">window</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">running</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">func</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">running</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span><span class="p">;</span> <span class="p">}</span>
      <span class="nx">running</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="c1">// 界面每次重绘(每秒60次)，只会触发一次scroll事件</span>
      <span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">obj</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="k">new</span> <span class="nx">CustomEvent</span><span class="p">(</span><span class="nx">name</span><span class="p">));</span>
        <span class="nx">running</span> <span class="o">=</span> <span class="nx">scroll</span>
      <span class="p">});</span>
    <span class="p">};</span>
    <span class="nx">obj</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">func</span><span class="p">);</span>
  <span class="p">};</span>
  <span class="c1">// 将 scroll 事件重定义为 optimizedScroll 事件</span>
  <span class="nx">throttle</span><span class="p">(</span><span class="s1">&#39;scroll&#39;</span><span class="p">,</span> <span class="s1">&#39;optimizedScroll&#39;</span><span class="p">);</span>
<span class="p">})();</span>

<span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;optimizedScroll&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Resource conscious scroll callback!&#39;</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>
<p>方法2：可以使用 setTimeout 增加间隔时间（0.1 秒执行一次）</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;scroll&#39;</span><span class="p">,</span> <span class="nx">scrollThrottler</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">scrollTimeout</span><span class="p">;</span>
  <span class="kd">function</span> <span class="nx">scrollThrottler</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">scrollTimeout</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">scrollTimeout</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">scrollTimeout</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">actualScrollHandler</span><span class="p">();</span>
      <span class="p">},</span> <span class="mf">100</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">actualScrollHandler</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">}</span>
<span class="p">}());</span>
</code></pre></div>
<p>方法3： 1秒一次</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span> <span class="nx">throttle</span><span class="p">(</span><span class="nx">fn</span><span class="p">,</span> <span class="nx">wait</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">time</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
  <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">((</span><span class="nx">time</span> <span class="o">+</span> <span class="nx">wait</span> <span class="o">-</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">fn</span><span class="p">();</span>
      <span class="nx">time</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;scroll&#39;</span><span class="p">,</span> <span class="nx">throttle</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="mf">1000</span><span class="p">));</span>
</code></pre></div>
<p>方法4：lodash库函数</p>
<div class="highlight"><pre><span></span><code><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;scroll&#39;</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">throttle</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="mf">1000</span><span class="p">));</span>
</code></pre></div>
<p>节流和防抖的区别：</p>
<p>debounce 是防抖，throttle 是节流。节流表示界面滚动每隔一段时间函数执行一次，防抖是界面滚动停止后，执行一次。</p>
<h4 id="10resize">10、resize<a class="headerlink" href="#10resize" title="Permanent link">&para;</a></h4>
<p>改变界面大小触发（会频繁触发，需要节流阀），主要发生在window上面。这里可以处理PC端界面向移动端界面切换时触发的函数。</p>
<div class="highlight"><pre><span></span><code><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;resize&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">clientWidth</span> <span class="o">&lt;</span> <span class="mf">768</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// mobile</span>
  <span class="p">}</span>
<span class="p">},</span> <span class="kc">true</span><span class="p">);</span>
</code></pre></div>
<h4 id="11fullscreenchange-fullscreenerror">11、fullscreenchange fullscreenerror<a class="headerlink" href="#11fullscreenchange-fullscreenerror" title="Permanent link">&para;</a></h4>
<p>Fullscreenchange 在开启或者退出全屏触发，fullscreenerror 会在全屏出错时触发。</p>
<h4 id="12">12、剪切板事件<a class="headerlink" href="#12" title="Permanent link">&para;</a></h4>
<p>cut copy paste 是 clipboardevent 的实例事件，具有一个属性 dataTransfer，可以存放剪切的数据。</p>
<div class="highlight"><pre><span></span><code><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;copy&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">e</span><span class="p">.</span><span class="nx">clipboardData</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s1">&#39;text/plain&#39;</span><span class="p">,</span> <span class="s1">&#39;版权所有，不得复制&#39;</span><span class="p">);</span>
  <span class="nx">e</span><span class="p">.</span><span class="nx">clipboardData</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s1">&#39;text/html&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;b&gt;Hello, world!&lt;/b&gt;&#39;</span><span class="p">);</span>
  <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
<span class="p">});</span>
<span class="c1">// 这里可以使复制进去剪切板的是开发者固定的内容，不是界面的内容。</span>
</code></pre></div>
<h4 id="13">13、焦点事件<a class="headerlink" href="#13" title="Permanent link">&para;</a></h4>
<p>focusin -&gt; focus -&gt; focusout -&gt; blur</p>
<p>这几个事件不会冒泡，所以需要在事件捕获阶段（addEventListener true）处理</p>
<h4 id="14customevent">14、CustomEvent<a class="headerlink" href="#14customevent" title="Permanent link">&para;</a></h4>
<p>生成自定义的事件实例</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span> <span class="nx">e</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CustomEvent</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>

<span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">detail</span><span class="o">:</span> <span class="s1">&#39;tell me info&#39;</span>
<span class="p">};</span>

<span class="nx">e</span><span class="p">.</span><span class="nx">detail</span> <span class="o">===</span> <span class="s1">&#39;tell me info&#39;</span>
</code></pre></div>
<p>eg2</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span> <span class="nx">myEvent</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CustomEvent</span><span class="p">(</span><span class="s1">&#39;myevent&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">detail</span><span class="o">:</span> <span class="p">{</span> <span class="nx">foo</span><span class="o">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">},</span>
  <span class="nx">bubbles</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">cancelable</span><span class="o">:</span> <span class="kc">false</span>
<span class="p">});</span>

<span class="nx">el</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;myevent&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Hello &#39;</span> <span class="o">+</span> <span class="nx">event</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">foo</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">el</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="nx">myEvent</span><span class="p">);</span>
</code></pre></div>
<h3 id="911-api">9.11 全局事件处理API<a class="headerlink" href="#911-api" title="Permanent link">&para;</a></h3>
<p>事件的回调函数有两种写法，addEventListener(type, function, true) 或者 onClick = function() {}</p>
<p>第二种方法简单使用方便，不能上设置捕获或者冒泡。由 GlobalEventHandlers 提供。下面是这个事件的属性</p>
<p>1、onabort 事件停止发生触发</p>
<div class="highlight"><pre><span></span><code>&lt;img src=&quot;example.jpg&quot; id=&quot;img&quot;/&gt;

var img = document.getElementById(&#39;img&#39;);
img.onabort = function () {
  console.log(&#39;image load aborted.&#39;);
}
</code></pre></div>
<p>2、onerror 错误时触发事件</p>
<p>当JS错误时，会传到 window.onerror</p>
<div class="highlight"><pre><span></span><code><span class="nb">window</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">source</span><span class="p">,</span> <span class="nx">lineno</span><span class="p">,</span> <span class="nx">colno</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">message</span><span class="err">：</span><span class="nx">错误信息字符串</span>
  <span class="nx">source</span><span class="err">：</span><span class="nx">报错脚本的</span> <span class="nx">URL</span>
  <span class="nx">lineno</span><span class="err">：</span><span class="nx">报错的行号</span><span class="err">，</span><span class="nx">是一个整数</span>
  <span class="nx">colno</span><span class="err">：</span><span class="nx">报错的列号</span><span class="err">，</span><span class="nx">是一个整数</span>
  <span class="nx">error</span><span class="err">：</span> <span class="nx">错误对象</span>
<span class="p">}</span>
</code></pre></div>
<p>资源加载错误（图片或者脚本错误）error会在当前元素触发，通常不会触发window.onerror</p>
<p>3、onload  onloadstart</p>
<p>window img 会在加载完毕后触发 onload</p>
<p>img video 在加载开始时，还会触发 onloadstart 事件</p>
<p>4、onfocsu onblur</p>
<p>获得或者失去焦点</p>
<p>5、onscroll</p>
<p>页面或者元素滚动（注意节流）</p>
<p>6、oncontextmenu onshow</p>
<p>元素上点击右键，会触发 oncontextmenu，如果返回true就显示右键菜单，如果返回false就不显示右键菜单。</p>
<p>显示右键菜单时，会触发 onshow 事件。</p>
<p>7、其他</p>
<div class="highlight"><pre><span></span><code><span class="nx">鼠标的事件属性</span><span class="err">。</span>
<span class="nx">onclick</span>
<span class="nx">ondblclick</span>
<span class="nx">onmousedown</span>
<span class="nx">onmouseenter</span>
<span class="nx">onmouseleave</span>
<span class="nx">onmousemove</span>
<span class="nx">onmouseout</span>
<span class="nx">onmouseover</span>
<span class="nx">onmouseup</span>
<span class="nx">onwheel</span>

<span class="nx">键盘的事件属性</span><span class="err">。</span>
<span class="nx">onkeydown</span>
<span class="nx">onkeypress</span>
<span class="nx">onkeyup</span>

<span class="nx">焦点的事件属性</span><span class="err">。</span>
<span class="nx">onblur</span>
<span class="nx">onfocus</span>

<span class="nx">表单的事件属性</span><span class="err">。</span>
<span class="nx">oninput</span>
<span class="nx">onchange</span>
<span class="nx">onsubmit</span>
<span class="nx">onreset</span>
<span class="nx">oninvalid</span>
<span class="nx">onselect</span>

<span class="nx">触摸的事件属性</span><span class="err">。</span>
<span class="nx">ontouchcancel</span>
<span class="nx">ontouchend</span>
<span class="nx">ontouchmove</span>
<span class="nx">ontouchstart</span>

<span class="o">-</span> <span class="nx">拖动的事件属性分成两类</span><span class="err">：</span><span class="nx">一类与被拖动元素相关</span><span class="err">，</span><span class="nx">另一类与接收被拖动元素的容器元素相关</span><span class="err">。</span>

<span class="nx">被拖动元素的事件属性</span><span class="err">。</span>
<span class="nx">ondragstart</span><span class="err">：</span><span class="nx">拖动开始</span>
<span class="nx">ondrag</span><span class="err">：</span><span class="nx">拖动过程中</span><span class="err">，</span><span class="nx">每隔几百毫秒触发一次</span>
<span class="nx">ondragend</span><span class="err">：</span><span class="nx">拖动结束</span>

<span class="nx">接收被拖动元素的容器元素的事件属性</span><span class="err">。</span>
<span class="nx">ondragenter</span><span class="err">：</span><span class="nx">被拖动元素进入容器元素</span><span class="err">。</span>
<span class="nx">ondragleave</span><span class="err">：</span><span class="nx">被拖动元素离开容器元素</span><span class="err">。</span>
<span class="nx">ondragover</span><span class="err">：</span><span class="nx">被拖动元素在容器元素上方</span><span class="err">，</span><span class="nx">每隔几百毫秒触发一次</span><span class="err">。</span>
<span class="nx">ondrop</span><span class="err">：</span><span class="nx">松开鼠标后</span><span class="err">，</span><span class="nx">被拖动元素放入容器元素</span><span class="err">。</span>

<span class="o">&lt;</span><span class="nx">dialog</span><span class="o">&gt;</span><span class="nx">对话框元素的事件属性</span><span class="err">。</span>
<span class="nx">oncancel</span>
<span class="nx">onclose</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../08-DOM/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 08-DOM" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              08-DOM
            </div>
          </div>
        </a>
      
      
        
        <a href="../10-BOM/" class="md-footer__link md-footer__link--next" aria-label="Next: 10-BOM" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              10-BOM
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; Michael An
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.febc23d1.min.js"></script>
      
        <script src="../../js/baidu-statistics.js"></script>
      
    
  </body>
</html>